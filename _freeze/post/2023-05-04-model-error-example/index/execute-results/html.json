{
  "hash": "c2ff44613f6f93d95ea8c5c6cf85d946",
  "result": {
    "markdown": "---\ntitle: \"Model error via regularised regression - CAS monograph data\"\nauthor: \"Grainne McGuire\"\ndate: '2023-05-04'\ndraft: true\ndescription: \"Estimate model error and other error via a Lasso bootstrap\"\ncategories: [\"Machine Learning\", \"R\", \"Lasso\", \"Model Error\", \"Bootstrap\"]\nimage: \"prior.png\"\nresources: \n  - \"_functions.R\"\n  - \"_meyersshi.csv\"\n---\n\n\n## Introduction\n\nIn [Taylor & McGuire (2022)](https://arxiv.org/abs/2210.01099), Greg Taylor and I looked at using the Lasso, together with Bayesian model averaging and the bootstrap procedure, to estimate internal model structure error in claims reserving. The paper contains the full details of the statistical framework used, so please refer to that for details of the approach.\n\nIn this article, or tutorial, what I'd like to share are the details of our bootstrapping approach which was behind the numerical results we discuss in Section 7 of the paper. This is because we consider that our approach tackles a number of practical problems faced by reserving actuaries:\n\n- Reserving actuaries must set uncertainty ranges on their reserves. Our approach estimates a number of components of forecast error - while our particular focus was on **Internal Model Structure Error** (refer to the discussion in Section 3 of the paper for definitions), we are also able to estimate parameter error as a by-product and process error as a straightforward bolt-on to the main process.\n\n- Our estimation of model error relies on the model set produced by the Lasso process - the set of models returned of varying complexities. We use Bayesian model averaging to combine these models, but this requires a prior on each model. In the Lasso framework, the prior falls naturally out of the penalty values, or $\\lambda$ parameters used to produce the model set.\n\n- The number of models within the Lasso model set is too sparse for reliable estimates of model error, so we use bootstrapping to augment the model set. We show how to bootstrap using a model produced by a Lasso. Furthermore, there are additional challenges in bootstrapping any model that extrapolates into future time periods in that models may display reasonable performance on past time periods, but extrapolate wildly into the future. This is an issue with any reserving model, but is magnified for machine learning models which do not have the same degree of curation to remove model terms that lead to wild behaviour.\n\n\nIn the paper used synthetic data sets in our examples since we were then able to control the complexity of experience within these and better understand the behaviour of model error in that context. Each data set was a 40x40 triangle of aggregate claims payments. However the computational requirements to run each of these are not particularly well-suited to a tutorial example - for example, a recent run of 500 bootstraps for one of the data sets took about 80 minutes using 10 parallel processes on a 16 core linux machine. So for this tutorial I've returned to the 10x10 aggregate triangle data we used in our CAS monograph, [Stochastic Loss Reserving using Generalized Linear Models](https://www.casact.org/monograph/cas-monograph-no-3). As well as being smaller, we have analysed the data in detail and understand it well. My [earlier post](../2019-11-07-traditional-style-reserving-using-glms/index.qmd) discusses this data set in more detail, so please refer to that and the monograph itself for further details.\n\nHowever, the same code is used in both examples and I will be adding a link to a notebook set up to run the synthetic data examples in due course, so that if you have the grunt power available to you, you can run the synthetic examples if you like (but note that the parallelisation used only works on linux machines - you will need to edit the code to run on windows machines). In the meantime, I suggest you try things on the smaller data set first.\n\nYou can download this file as a quarto notebook [here](./_cas_monograph_model_error_example.qmd).\n\n### Pre-requisites\n\n- This builds on the modelling approach in [Self-Assembling Insurance Claim Models Using Regularized Regression and Machine Learning](https://variancejournal.org/article/28366-self-assembling-insurance-claim-models-using-regularized-regression-and-machine-learning), so you may need to consult that paper if you are unfamiliar with it.\n- An [earlier article](../2019-05-31-self-assembling-claim-reserving-models/index.qmd) works through the details of the model fitting in R.\n- The code underlying this is reasoanbly complex and is contained in functions in [_functions.R](./_functions.R). To really dig into the details of what's going on, you may need to look at the R code.\n\n## R Setup\n\nFirst I set up my R environment:\n\n- Packages used (see bottom of this article for package versions). One thing I recommend is to check you have a recent version of [glmnet](https://CRAN.R-project.org/package=glmnet) (4.1-4 or later) since the package was changed to use C++ at that point leading to spped-ups in runtimes.\n- colours and [ggplot2](https://CRAN.R-project.org/package=ggplot2) theme settings\n- Functions used to run the code - the main parts of the code are sitting in the file [_functions.R](./_functions.R). **Please note that these functions don't contain much error catching so use them carefully and at your own risk**. If you run into problems you may need to use R debugging tools to work out your error.\n\n\n::: {.cell}\n\n```\n## here() starts at C:/Work/Research/grainnemcguire.github.io\n## Loading required package: Matrix\n## Loaded glmnet 4.1-7\n## Loading required package: viridisLite\n## \n## Attaching package: 'viridis'\n## The following object is masked from 'package:scales':\n## \n##     viridis_pal\n## Loading required package: foreach\n## Loading required package: iterators\n## Loading required package: parallel\n```\n:::\n\n\n\ncheck for conflicts and resolve if needed (one conflict found).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconflict_scout()\n## 1 conflict\n## â€¢ `viridis_pal()`: viridis and scales\nconflict_prefer(\"viridis_pal\", \"viridis\")\n## [conflicted] Will prefer viridis::viridis_pal over any other package.\n```\n:::\n\n\nNext I set up some things I'll be using below:\n\n- `main_model`: Lasso models are a series of models, and we'll need to specify one as our preferred or primary model. We use the one labelled as `lambda.1se` by `glmnet` - this is the model within 1 standard deviation of the minimum cross validation error model, often favoured by users as a good trade-off between quality of fit and overfitting\n- `list_dt_filter_params` which holds inclusion gates for the bootstrap. There's more information on these in the paper and below so I'll defer discussion until then.\n- `num_bootstraps` is the number of bootstraps to run. I've set this to 100 for the tutorial to keep runtimes manageable, but would recommend more in practice. If you're running the code, I'd recommend you set it something small like 10 first, just to make sure everything runs, and then increase it to a reasonable number.\n- `num_workers` and `batchsize` relate to running code in parallel (not done here). Since we run sequentially, set `batchsize` equal to `num_bootstraps`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmain_model <- \"lambda.1se\"\n\n# inclusion gates for bootstrap\nlist_dt_filter_params <- list(\n  main = list(\n    acc  = data.table(period = c(2, 5, 10), cutoff = c(1.33, 1.25, 1.20)),\n    cal  = data.table(period = c(2, 5, 10), cutoff = c(1.10, 1.15, 1.20))\n  ))\n\n# set initial wider gates\ninit_scale <- 1.4\nlist_dt_filter_params$initial <- list(\n  acc = copy(list_dt_filter_params$main$acc)[, cutoff := cutoff * init_scale],\n  cal = copy(list_dt_filter_params$main$cal)[, cutoff := cutoff * init_scale]\n)\n\n# number of bootstraps\nnum_bootstraps <- 100\nnum_workers <- 1  # we run sequentially\nbatchsize <- num_bootstraps/ num_workers \nuse_parallel <- FALSE\n```\n:::\n\n\n\n\n## Data\n\n- The data is located [here](./_meyersshi.csv)\n- I've loaded in the data below using `data.table::fread()`. The file path is set using the [here package]( https://CRAN.R-project.org/package=here).\n  - I use `data.table` for all my data manipulations - I'll aim to describe what each code chunk is doing so even if you're unfamiliar with `data.table` syntax, you'll be able to follow along.\n  - I also use the [DT](https://CRAN.R-project.org/package=DT) to print out nicely formatted tables using the function `DT::datatable()` - this is not related to the `data.table` package.\n- I need to do some preparing of the data:\n  - The csv file only contains past data, but I want past and future so I use `data.table::CJ()` to build the full 10x10 skeleton before merging past data on\n  - My model error code requires column names `acc`, `dev`, `cal`, `past_ind` and `pmts` so I make sure I have all the right columns and names after this process.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# edit as needed for your file path\ndt_raw <- fread(here(\"post\", \"2023-05-04-model-error-example\", \"_meyersshi.csv\"))\n\n# put into matching form\ndt <- CJ(acc = 1:10, dev = 1:10)\ndt[, cal := acc + dev - 1]\ndt[, past_ind := cal <= 10]\n\ndt[ dt_raw, on=.(acc = acc_year, dev = dev_year), pmts := i.incremental]\n\n# Look at the data\ndatatable(dt)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-04fa34e5e0f8474158f0\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-04fa34e5e0f8474158f0\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\"],[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10],[1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10],[1,2,3,4,5,6,7,8,9,10,2,3,4,5,6,7,8,9,10,11,3,4,5,6,7,8,9,10,11,12,4,5,6,7,8,9,10,11,12,13,5,6,7,8,9,10,11,12,13,14,6,7,8,9,10,11,12,13,14,15,7,8,9,10,11,12,13,14,15,16,8,9,10,11,12,13,14,15,16,17,9,10,11,12,13,14,15,16,17,18,10,11,12,13,14,15,16,17,18,19],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,false,false,true,true,true,true,true,true,true,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true,false,false,false,false,false,true,true,true,true,false,false,false,false,false,false,true,true,true,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false],[41821,34729,20147,15965,11285,5924,4775,3742,3435,2958,48167,39495,24444,18178,10840,7379,5683,4758,3959,null,52058,47459,27359,17916,11448,8846,5869,5391,null,null,57251,49510,27036,20871,14304,10552,7742,null,null,null,59213,54129,29566,22484,14114,10000,null,null,null,null,59475,52076,26836,22332,14756,null,null,null,null,null,65607,44648,27062,22655,null,null,null,null,null,null,56748,39315,26748,null,null,null,null,null,null,null,52212,40030,null,null,null,null,null,null,null,null,43962,null,null,null,null,null,null,null,null,null]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>acc<\\/th>\\n      <th>dev<\\/th>\\n      <th>cal<\\/th>\\n      <th>past_ind<\\/th>\\n      <th>pmts<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,5]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nWe can also look at the data graphically too.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=dt[past_ind==TRUE,], aes(x=dev, y=log(pmts), colour=as.factor(acc)))+\n  geom_line(linewidth = 1)+\n  scale_colour_viridis_d(begin=1, end=0, alpha=1)+\n  theme(legend.position = \"none\")+\n  labs(title=\"Each line is an accident quarter\", x=\"Development quarter\", y=\"log(Payments)\")+\n  NULL\n\np2 <- ggplot(data=dt[past_ind==TRUE,], aes(x=dev, y=log(pmts), colour=as.factor(cal)))+\n  geom_line(linewidth = 1)+\n  scale_colour_viridis_d(begin=0, end=1, alpha=1)+\n  theme(legend.position = \"none\")+\n  labs(title=\"Each line is a calendar quarter\", x=\"Development quarter\", y=\"log(Payments)\")+\n  NULL\n\np1 + p2   # patchwork to combine plots\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\n## Primary model\n\nNow we built the Lasso model of the data. We use the approach described in our earlier paper, [Self-Assembling Insurance Claim Models Using Regularized Regression and Machine Learning](https://variancejournal.org/article/28366-self-assembling-insurance-claim-models-using-regularized-regression-and-machine-learning). My [previous article](../2019-05-31-self-assembling-claim-reserving-models/index.qmd) explains this process in more detail so please refer to that to fill in the gaps - e.g. if you need further details on the basis functions used, how they are defined, scaled etc.\n\nFrom the CAS monograph work we know that the data are modelled reasonably well by a Chain Ladder model (though our optimal GLM included some accident and development year interactions). So we use this information and only consider accident and development year basis functions. This choice is also motivated by practical reasons - fewer basis functions will make the code run faster, which suits the purposes of this tutorial.\n\nThere are a number of tasks we need to do when fitting the model. These include:\n\n- Creating the basis functions to use in the fitting process\n- Fitting the model\n- Calculating a scale parameter for use in bootstrapping\n- Producing model forecasts\n- Producing model residuals using the main selected model (lambda.1se in our case) and the scale parameter and looking at some diagnostics\n- Specifying the prior\n- Producing the initial Bayesian model averaging results from the primary model - this is for interest only - as discussed in our paper, the model set is a bit too sparse to produce reliable estimates of variability, so we need to augment with bootstrapped samples.\n\n\n\nFirst we create list object to hold all of these results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_primary <- list()\n\nlist_primary$data <- copy(dt)\n```\n:::\n\n\n\n### Basis functions for lasso\n\nCreate the basis functions - first create a `predictor_obj` to hold the settings - e.g. what fundamental variables to include, scaling, what interactions to include. Then use a function to create the basis functions.\n\nAs discussed in my [earlier article](../2019-05-31-self-assembling-claim-reserving-models/index.qmd), I've gone through a few iterations of the basis function code over the years so what's in [_functions.R](./_functions.R) may be be a bit different to what's discussed there.\n\n::: panel-tabset\n\n#### Predictor object {-}\n\nSet up a predictor object to give information about each of the predictors so that basis functions can be constructed.\n\nThe predictor object should contain\n\n- `num_predictors` (2 - acc and dev)\n- `predictors`\n- `min` - min value of each predictor\n- `max` - max value of each predictor\n- `ramp_inc` - we build a series of ramp functions and this indicates the increment. Always 1 for things like accident and development period\n- `scaling` - this uses the `GetScaling()` function and applies to the fundamental vector - see the previous articles for more details on scaling\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_primary$predictor_obj <- list()\n\nlist_primary$predictor_obj$num_predictors <- 2\nlist_primary$predictor_obj$predictors <- c(\"acc\", \"dev\")  \nlist_primary$predictor_obj$min <- c(1, 1)\nlist_primary$predictor_obj$max <- c(10, 10)\nlist_primary$predictor_obj$ramp_inc <- c(1, 1)\nlist_primary$predictor_obj$scaling <- c(GetScaling(dt[past_ind==TRUE, acc]), \n                                        GetScaling(dt[past_ind==TRUE, dev])) \n```\n:::\n\n\n\n#### Basis functions {-}\n\n- We produce a matrix of all the basis functions. For convenience, this is separated into past and future components as well.\n- The parameter `int_effects_list` is used to specify what interactions to create - in this case all $I(\\text{acc} \\ge i) . I(\\text(dev) \\ge j)$ heaviside interactions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_primary$varset <- vector(mode=\"list\", length=3)\nnames(list_primary$varset) <- c(\"all\", \"past\", \"future\")\n\n# all data (NB scaling above based on past data only)\nlist_primary$varset$all <- GenerateVarset(data = dt,\n                                     predictor_object = list_primary$predictor_obj,\n                                     main_effects_list = c(\"acc\", \"dev\"),\n                                     int_effects_list = list(c(\"acc\", \"dev\")))\n\n# past data\nlist_primary$varset$past <- list_primary$varset$all[dt[, past_ind], ]\n\n# future data\nlist_primary$varset$future <- list_primary$varset$all[!dt[, past_ind], ]\n\n\n# look at start of matrix to see what it looks like\nlist_primary$varset$all[41:46, 1:10]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     L_1_999_acc L_2_999_acc L_3_999_acc L_4_999_acc L_5_999_acc L_6_999_acc\n[1,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n[2,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n[3,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n[4,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n[5,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n[6,]    1.632993    1.224745   0.8164966   0.4082483           0           0\n     L_7_999_acc L_8_999_acc L_9_999_acc L_1_999_dev\n[1,]           0           0           0   0.0000000\n[2,]           0           0           0   0.4082483\n[3,]           0           0           0   0.8164966\n[4,]           0           0           0   1.2247449\n[5,]           0           0           0   1.6329932\n[6,]           0           0           0   2.0412415\n```\n:::\n:::\n\n\n:::\n\n\n\n### Lasso fitting\n\n- Here we fit Lasso models using the `glmnet` package. \n  - Although we use the gamma distribution later in our analysis, we use the Poisson distribution with glmnet when generating our model set since we had convergence issues when using the gamma distribution.\n  - You'll notice we do 3 fits:\n    - The first generates a series of lambda values, but does not do the cross validation\n    - In the second we lengthen the lambda vector to smaller values to ensure that we do reach the minimum cross validation model and then run the cross-validation fitting process. We also add additional values between each lambda to pad out our model set as much as possible.\n- I've also specified values for `pmax` and `dfmax` but in this example, these are just the defaults used by `glmnet`. I need to explicitly set them for the bootstrapping functions below which is why I've done it here.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfmax_default <- ncol(list_primary$varset$past) + 1  # default setting of nvars+1\npmax_default <- min(dfmax_default*2 + 20, ncol(list_primary$varset$past))\n\nset.seed(77)\n\naaa <- glmnet(x=list_primary$varset$past, \n              y=dt[past_ind==TRUE, pmts],\n              family = \"poisson\",\n              dfmax = dfmax_default, \n              pmax = pmax_default, \n              nlambda = 50, \n              thresh = 1e-08, \n              lambda.min.ratio = 0,               \n              alpha=1, \n              standardize = FALSE,\n              maxit=1000000)\n\n# lengthen the lambda vector\norig_lambdavec <- c(aaa$lambda, min(aaa$lambda)*(0.85^(1:50)))  # lengthen lambda vector\n\n# pad the lambda vector\nlambdavec <- NULL\nfor(i in 1:(length(orig_lambdavec) - 1)){\n  lambdavec <- c(lambdavec, seq(from = orig_lambdavec[i], to = orig_lambdavec[i+1], length.out = 5))\n}\n\n# remove dups\nlambdavec <- sort( unique(lambdavec), decreasing = TRUE)\n\n\n\n\nset.seed(87)\nlist_primary$glmnet_obj <- cv.glmnet(x = list_primary$varset$past,\n                                y = dt[past_ind==TRUE, pmts],\n                                family = \"poisson\",\n                                lambda=lambdavec,\n                                dfmax = dfmax_default, \n                                pmax = pmax_default, \n                                thresh = 1e-8,\t\n                                alpha = 1,          # review after moving to agg data\n                                standardize = FALSE,\n                                nfolds = 8, \n                                parallel=FALSE,\n                                relax=FALSE,\n                                trace.it = FALSE,  # TRUE in notebooks leads to unpleasant output\n                                maxit = 1000000)\n\n\n# cleanup\nrm(aaa)\n```\n:::\n\n\n\nCheck the fit looks reasonable - main thing to ensure is that the two vertical lines (which mark the lambda.min and the lambda.1se models) are not at the end of the plot, which would indicate that the lambda vector isn't long enough (though after our manipulation of the vector above, it should be).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(list_primary$glmnet_obj)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n### Scale parameter \n\nNow we have a set of models and a main model in that corresponding to the lambda.1se value, we can now estimate a scale parameter assuming a gamma distribution. We do this by fitting a gamma GLM to the lambda.1se model structure and taking the scale parameter from that.\n\nAs a minor technical point, we use `MASS::gamma.shape()` to get the scale parameter estimate rather than that from `glm()` directly. This is discussed further [here](https://rdrr.io/cran/MASS/man/gamma.shape.glm.html).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# coefficients in lambda.1se model\ncoefs <- predict(list_primary$glmnet_obj, type = \"coefficients\", s = list_primary$glmnet_obj[[main_model]])\ncoefnames <- c(\"Intercept\", colnames(list_primary$varset$past))\n\n# extract the non-zero coefficients\nind_nz_coefs <- which(!(coefs == 0))\nnz_coefs <- coefs[ind_nz_coefs]\nnz_coefnames <- coefnames[ind_nz_coefs]\n\n# get the past_varset with just these observations\npast_varset_small <- list_primary$varset$past[, nz_coefnames[-1]]   # the -1 removes the intercept\nglm_data = as.data.table(cbind(dt[past_ind==TRUE, .(pmts)], past_varset_small))\n\nglm_formula = as.formula(paste(\"pmts~\", paste(nz_coefnames[-1], collapse = \"+\")))\n\n\n#glm_formula\ngamma_mod_1 = glm(formula=glm_formula, family = Gamma(link=\"log\"), data = glm_data)\n\nsummary(gamma_mod_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = glm_formula, family = Gamma(link = \"log\"), data = glm_data)\n\nDeviance Residuals: \n      Min         1Q     Median         3Q        Max  \n-0.136693  -0.048222   0.001886   0.041310   0.142041  \n\nCoefficients:\n            Estimate Std. Error t value             Pr(>|t|)    \n(Intercept) 10.65861    0.03428 310.959 < 0.0000000000000002 ***\nL_1_999_acc  0.28652    0.03021   9.485     0.00000000000266 ***\nL_4_999_acc -0.19576    0.11254  -1.739              0.08879 .  \nL_5_999_acc -0.13971    0.18239  -0.766              0.44768    \nL_6_999_acc -0.01031    0.20091  -0.051              0.95930    \nL_7_999_acc -0.18356    0.15684  -1.170              0.24801    \nL_1_999_dev -0.50158    0.08647  -5.801     0.00000061660403 ***\nL_2_999_dev -0.71488    0.14832  -4.820     0.00001672460156 ***\nL_3_999_dev  0.27983    0.10398   2.691              0.00996 ** \nL_6_999_dev  0.38128    0.05998   6.356     0.00000009220787 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Gamma family taken to be 0.005763095)\n\n    Null deviance: 36.19257  on 54  degrees of freedom\nResidual deviance:  0.26121  on 45  degrees of freedom\nAIC: 967.87\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\n\nExtract the updated scale parameter estimate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_primary$scale <- round(summary(gamma_mod_1, dispersion = MASS::gamma.dispersion(gamma_mod_1))$dispersion, 4)\n\nprint(list_primary$scale)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0047\n```\n:::\n:::\n\n\n\n### Forecasts and residuals\n\n- Calculate forecasts under both lambda.min and lambda.1se models and add these to `list_primary$data`\n- Make pred field from the main model (currently lambda.1se)\n- Calculate Pearson residuals\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add predictions under the two models for the min, 1se lambda values\nlist_primary$data[, lambda.1se := predict(list_primary$glmnet_obj, newx = list_primary$varset$all, type=\"response\", s=\"lambda.1se\")]\nlist_primary$data[, lambda.min := predict(list_primary$glmnet_obj, newx = list_primary$varset$all, type=\"response\", s=\"lambda.min\")]\n\n\n# make pred = selected model, pred will be used later in bootstrapping\n# calculate residuals - (actual - expected)/stdev\nlist_primary$data[, pred := get(main_model)]  # duplicate for convenience\nlist_primary$data[past_ind == TRUE, var_pred := (pred^2)*(list_primary$scale)\n                  ][past_ind == TRUE, resid := (pmts - pred)/sqrt(var_pred)]\n\n\n# also calculate reserve values\nlist_primary$reserves <- vector(mode=\"list\", length = 3)\nnames(list_primary$reserves) <- c(\"primary\", \"lambda.1se\", \"lambda.min\")\n\n# lambda.1se\nlist_primary$reserves$lambda.1se <- list_primary$data[past_ind==FALSE, sum(lambda.1se)]\n# lambda.min\nlist_primary$reserves$lambda.min <- list_primary$data[past_ind==FALSE, sum(lambda.min)]\n# selected aka primary\nlist_primary$reserves$primary <- list_primary$reserves[[main_model]]\n\n# look at reserves\nas.data.table(list_primary$reserves)  |>  \n  datatable()  |>  \n  formatRound(names(list_primary$reserves), digits=0)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-067eb3bdfee640402158\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-067eb3bdfee640402158\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\"],[368120.791348077],[368120.791348077],[370802.251723361]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>primary<\\/th>\\n      <th>lambda.1se<\\/th>\\n      <th>lambda.min<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nSo the reserve under our main model is 368121 - for reference our final estimate in the CAS monograph work was $370,493.\n\n\n#### Model diagnostics {.unnumbered}\n\n::: panel-tabset\n\n\n##### Residual scatterplots {.unnumbered}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data=list_primary$data[past_ind==TRUE,], aes(x=log(pred), y=resid, colour=dev)) +\n    geom_point(size=2) +\n    scale_colour_viridis(begin=0.9, end=0) +\n    theme(legend.position = \"none\") +\n    ggtitle(\"Linear predictor\")\n\n\np2 <- ggplot(data=list_primary$data[past_ind==TRUE,], aes(x=acc, y=resid)) +\n    geom_point(size=2, colour=me_colours$blue) +\n    ggtitle(\"Accident\")\n\np3 <- ggplot(data=list_primary$data[past_ind==TRUE,], aes(x=dev, y=resid)) +\n    geom_point(size=2, colour=me_colours$blue) +\n    ggtitle(\"Development\")\n\np4 <- ggplot(data=list_primary$data[past_ind==TRUE,], aes(x=cal, y=resid)) +\n    geom_point(size=2, colour=me_colours$blue) +\n    ggtitle(\"Calendar\")\n\n(p1 + p2) / (p3 + p4)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/residual-plots-1.png){width=672}\n:::\n:::\n\n\n\n##### Residual density plot {.unnumbered}\n\n\nHave a look at the density plot of residuals too\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=list_primary$data[past_ind==TRUE]) +\n  geom_density(aes(resid, after_stat(density)), fill=me_colours$blue, colour=me_colours$blue) +\n  stat_function(fun = dnorm, colour=me_colours$orange, linewidth=2) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/residual-density-1.png){width=672}\n:::\n:::\n\n\n\n\n##### AvsE heatmaps {.unnumbered}\n\nThis plots shaded actual/expected values where white is close to 100%, red is where actual exceed expected (capped at 200%) and blue is where actual is less than expected (cupped at 50%).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_forecasts_long <- melt(list_primary$data, \n                             measure.vars = c(\"lambda.1se\", \"lambda.min\"), \n                             id.vars=c(\"acc\", \"dev\", \"cal\", \"pmts\"),\n                             variable.name = \"model\",\n                             value.name = \"fitted\")\n\ng <- GraphHeatMap(model_forecasts_long, x=\"dev\", y=\"acc\", facet=\"model\", actual=\"pmts\", fitted=\"fitted\", \n                  xlab=\"Development quarter\", ylab=\"Accident quarter\")\ng$graph\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/heatmap-plot-1.png){width=672}\n:::\n:::\n\n\n:::\n\n\n### Prior\n\n- In our paper we discuss different possibilities for priors, so refer to that discussion there\n- Because the Lasso is fitted using a poisson, but our analysis assumes a gamma distribution, we need to solve for the priors that produce the desired properties, rather than use the glmnet lambda values directly\n- The process is as follows:\n  - We specify the priors for the model parameters assuming a laplace distribution\n    - A fairly wide prior for the intercept term centred on the log(average past payments)\n    - A common scale parameter specified by us for all other coefficient and a prior mean of 0\n  - We then calculate the posterior distribution of each model given the laplace prior and a gamma log likelihood\n  - We plot the posterior distributions and select the prior values that we wish\n    - e.g. the prior value that leads to the lambda.1se coinciding with the posterior mode.\n\n#### Filtering\n\nAs this state we should briefly discuss filtering or the inclusion gates - refer to section 5.2.5 of the paper and Table 5-1 therein as well as to the `list_dt_filter_params` object here.\n\nThe idea behind filtering is simple - we want to exclude models that extrapolate in a wild manner, and to an extend that an actuary would consider the model reasonable. In the paper we discussed how we looked at forecasts of different periods of payment (calendar periods) and accident periods and based the gates on that.\n\nI have retained the same inclusion gates for this data as for the simulated data. The filtering is implemented by my `CalculatePosterior()` function.\n\n\n#### Code for searching for the priors\n\nUsing a bit of trial and error and the code below, I came up with prior values for the four different types of prior considered in our paper.\n\nThe graph below won't win any data visualisation contests, but captures the various bits and pieces of information I've used to interactively find the priors.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_pp <- list(\n  laplace_m_intercept = dt[past_ind==TRUE, log(mean(pmts))],   # prior mean of intercept\n  laplace_s_intercept = 2,     # scale for the intercept - must be large since results not centred so intercept can be long way from data average\n  laplace_m_parameters = 0,    # prior mean for the non-intercept params\n  laplace_s_parameters = 0.029,   \n  prior_name = \"finding_priors\"\n)\n\ndt_post <- CalculatePosterior(list_primary$data, \n                              glmnet_obj = list_primary$glmnet_obj, \n                              varset = list_primary$varset$all,\n                              yvar = \"pmts\", \n                              dt_scaling_factor = NULL, \n                              list_filter = list_dt_filter_params$main, \n                              list_prior_params = list_pp, \n                              prior_name = NULL,\n                              scale = list_primary$scale)$probs\n\n\n# plot ----;\n# first get some quantities to put on the plot that we use in search for priors\nmn_1se <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"1se\"]\nmn_min <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"min\"]\nmn_max_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), model_num]\nmax_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), posterior]  # used for drawing lines on graph\nsum_prob_ge_1se <- round(dt_post[model_num >= mn_1se, sum(posterior)], 5)\nsum_prob_le_min <- round(dt_post[model_num <= mn_min, sum(posterior)], 5)\nsum_prob_ge_1se_label <- paste(\"Pr(>= 1se) = \", sum_prob_ge_1se, \"\\nso\", 1-sum_prob_ge_1se, \"in shaded area\")\nsum_prob_le_min_label <- paste(\"Pr(<= min) = \", sum_prob_le_min, \"\\nso\", 1-sum_prob_le_min, \"in shaded area\")\n\n\nggplot(data = dt_post, mapping = aes(x = model_num, y = posterior)) + \n  # max post line\n  annotate(\"segment\", x = mn_max_post, xend = mn_max_post, y=0, yend = max_post, colour = me_colours$teal, linewidth=1.5, linetype = 2) +\n  annotate(\"text\", x = mn_max_post, y = 1*max_post/3, label=paste(\"Max posterior model\"), colour = me_colours$teal) +\n  # 1se shaded box\n  annotate(\"rect\", xmin = min(dt_post$model_num), xmax = mn_1se, ymin = 0, ymax = max_post, fill = me_colours$orange, alpha = 0.1)+\n  annotate(\"text\", x = min(dt_post$model_num), y = 5*max_post/6, label=sum_prob_ge_1se_label, colour = me_colours$orange, hjust = 0) +\n  # min shaded box\n  annotate(\"rect\", xmin = mn_min, xmax = max(dt_post$model_num), ymin = 0, ymax = max_post, fill = me_colours$red, alpha = 0.1)+\n  annotate(\"text\", x = max(dt_post$model_num) + 2, y = 5*max_post/6, label=sum_prob_le_min_label, colour = me_colours$red, hjust = 1) +\n  # 1se line\n  annotate(\"segment\", x = mn_1se, xend = mn_1se, y=0, yend = max_post, colour = me_colours$orange) +\n  annotate(\"text\", x = mn_1se, y = 2*max_post/3, label=paste(\"lambda.1se model\"), colour = me_colours$orange) +\n  # min line\n  annotate(\"segment\", x = mn_min, xend = mn_min, y=0, yend = max_post, colour = me_colours$red) +\n  annotate(\"text\", x = mn_min, y = max_post/2, label=paste(\"lambda.min model\"), colour = me_colours$red) +\n  # posterior\n  geom_line(colour = me_colours$blue) +\n  labs(title = paste(\"Selecting prior - laplace scale is\", list_pp$laplace_s_parameters),\n       subtitle = paste(\"Max post = 1se:\", mn_max_post == mn_1se, \"\\nMax post = min:\", mn_max_post == mn_min)) +\n  # coord_cartesian(xlim=c(50, 150))+   # can use this to zoom in on parts of the graph\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\nUsing the code chunk above, I've found the priors corresponding to those used in our paper.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_primary$prior$list_prior_params <- list(\n  laplace_m_intercept = dt[past_ind==TRUE, log(mean(pmts))],   # prior mean of intercept\n  laplace_s_intercept = 2,     # scale for the intercept - must be large since results not centred so intercept can be long way from data average\n  laplace_m_parameters = 0,    # prior mean for the non-intercept params\n  laplace_s_parameters = c(0.01505, 0.029, 0.38, 1.55),\n  prior_name = c(\"simple\", \"lambda.1se\", \"lambda.min\", \"complex\")\n)\n```\n:::\n\n\n\n### Posterior distributions \n\nI've shown all four prior possibilities here, but later on will mainly focus on the results relating to the lambda.1se results.\n\n::: panel-tabset\n\n\n#### Simple {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndt_post <- CalculatePosterior(list_primary$data, \n                         glmnet_obj = list_primary$glmnet_obj, \n                         varset = list_primary$varset$all,\n                         yvar = \"pmts\", \n                         dt_scaling_factor = NULL, \n                         list_filter = list_dt_filter_params$main, \n                         list_prior_params = list_primary$prior$list_prior_params, \n                         prior_name = \"simple\",\n                         scale = list_primary$scale)$probs\n\n\n# plot ----;\n# first get some quantities to put on the plot that we use in search for priors\nmn_1se <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"1se\"]\nmn_min <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"min\"]\nmn_max_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), model_num]\nmax_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), posterior]  # used for drawing lines on graph\nsum_prob_ge_1se <- round(dt_post[model_num >= mn_1se, sum(posterior)], 5)\nsum_prob_le_min <- round(dt_post[model_num <= mn_min, sum(posterior)], 5)\nsum_prob_ge_1se_label <- paste(\"Pr(>= 1se) = \", sum_prob_ge_1se)\nsum_prob_le_min_label <- paste(\"Pr(<= min) = \", sum_prob_le_min)\npval <- list_primary$prior$list_prior_params$laplace_s_parameters[which(list_primary$prior$list_prior_params$prior_name == dt_post[1, prior_name])]\n\nggplot(data = dt_post, mapping = aes(x = model_num, y = posterior)) + \n  # max post line\n  # annotate(\"segment\", x = mn_max_post, xend = mn_max_post, y=0, yend = max_post, colour = me_colours$teal, linewidth=1.5, linetype = 2) +\n  # annotate(\"text\", x = mn_max_post, y = 1*max_post/3, label=paste(\"Max posterior model\"), colour = me_colours$teal) +\n  # 1se shaded box\n  annotate(\"rect\", xmin = min(dt_post$model_num), xmax = mn_1se, ymin = 0, ymax = max_post, fill = me_colours$orange, alpha = 0.1)+\n  annotate(\"text\", x = min(dt_post$model_num), y = 5*max_post/6, label=sum_prob_ge_1se_label, colour = me_colours$orange, hjust = 0) +\n  # min shaded box\n  # annotate(\"rect\", xmin = mn_min, xmax = max(dt_post$model_num), ymin = 0, ymax = max_post, fill = me_colours$red, alpha = 0.1)+\n  # annotate(\"text\", x = max(dt_post$model_num) + 2, y = 5*max_post/6, label=sum_prob_le_min_label, colour = me_colours$red, hjust = 1) +\n  # 1se line\n  annotate(\"segment\", x = mn_1se, xend = mn_1se, y=0, yend = max_post, colour = me_colours$orange) +\n  annotate(\"text\", x = mn_1se, y = 2*max_post/3, label=paste(\"lambda.1se model\"), colour = me_colours$orange) +\n  # min line\n  annotate(\"segment\", x = mn_min, xend = mn_min, y=0, yend = max_post, colour = me_colours$red) +\n  annotate(\"text\", x = mn_min, y = max_post/2, label=paste(\"lambda.min model\"), colour = me_colours$red) +\n  # posterior\n  geom_line(colour = me_colours$blue) +\n  labs(title = paste(dt_post[1, prior_name], \"prior - laplace scale is\", pval))+\n  coord_cartesian(xlim = c(50, 150)) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=768}\n:::\n:::\n\n\n\n#### lambda.1se {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndt_post <- CalculatePosterior(list_primary$data, \n                         glmnet_obj = list_primary$glmnet_obj, \n                         varset = list_primary$varset$all,\n                         yvar = \"pmts\", \n                         dt_scaling_factor = NULL, \n                         list_filter = list_dt_filter_params$main, \n                         list_prior_params = list_primary$prior$list_prior_params, \n                         prior_name = \"lambda.1se\",\n                         scale = list_primary$scale)$probs\n\n\n# plot ----;\n# first get some quantities to put on the plot that we use in search for priors\nmn_1se <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"1se\"]\nmn_min <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"min\"]\nmn_max_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), model_num]\nmax_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), posterior]  # used for drawing lines on graph\nsum_prob_ge_1se <- round(dt_post[model_num >= mn_1se, sum(posterior)], 5)\nsum_prob_le_min <- round(dt_post[model_num <= mn_min, sum(posterior)], 5)\nsum_prob_ge_1se_label <- paste(\"Pr(>= 1se) = \", sum_prob_ge_1se)\nsum_prob_le_min_label <- paste(\"Pr(<= min) = \", sum_prob_le_min)\npval <- list_primary$prior$list_prior_params$laplace_s_parameters[which(list_primary$prior$list_prior_params$prior_name == dt_post[1, prior_name])]\n\nggplot(data = dt_post, mapping = aes(x = model_num, y = posterior)) + \n  # max post line\n  annotate(\"segment\", x = mn_max_post, xend = mn_max_post, y=0, yend = max_post, colour = me_colours$teal, linewidth=1.5, linetype = 2) +\n  annotate(\"text\", x = mn_max_post, y = 1*max_post/3, label=paste(\"Max posterior model\"), colour = me_colours$teal) +\n  # 1se shaded box\n  # annotate(\"rect\", xmin = min(dt_post$model_num), xmax = mn_1se, ymin = 0, ymax = max_post, fill = me_colours$orange, alpha = 0.1)+\n  # annotate(\"text\", x = min(dt_post$model_num), y = 5*max_post/6, label=sum_prob_ge_1se_label, colour = me_colours$orange, hjust = 0) +\n  # min shaded box\n  # annotate(\"rect\", xmin = mn_min, xmax = max(dt_post$model_num), ymin = 0, ymax = max_post, fill = me_colours$red, alpha = 0.1)+\n  # annotate(\"text\", x = max(dt_post$model_num) + 2, y = 5*max_post/6, label=sum_prob_le_min_label, colour = me_colours$red, hjust = 1) +\n  # 1se line\n  annotate(\"segment\", x = mn_1se, xend = mn_1se, y=0, yend = max_post, colour = me_colours$orange) +\n  annotate(\"text\", x = mn_1se, y = 2*max_post/3, label=paste(\"lambda.1se model\"), colour = me_colours$orange) +\n  # min line\n  annotate(\"segment\", x = mn_min, xend = mn_min, y=0, yend = max_post, colour = me_colours$red) +\n  annotate(\"text\", x = mn_min, y = max_post/2, label=paste(\"lambda.min model\"), colour = me_colours$red) +\n  # posterior\n  geom_line(colour = me_colours$blue) +\n  labs(title = paste(dt_post[1, prior_name], \"prior - laplace scale is\", pval))+\n  coord_cartesian(xlim = c(50, 150)) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=768}\n:::\n:::\n\n\n\n\n\n#### lambda.min {.unnumbered}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndt_post <- CalculatePosterior(list_primary$data, \n                         glmnet_obj = list_primary$glmnet_obj, \n                         varset = list_primary$varset$all,\n                         yvar = \"pmts\", \n                         dt_scaling_factor = NULL, \n                         list_filter = list_dt_filter_params$main, \n                         list_prior_params = list_primary$prior$list_prior_params, \n                         prior_name = \"lambda.min\",\n                         scale = list_primary$scale)$probs\n\n\n# plot ----;\n# first get some quantities to put on the plot that we use in search for priors\nmn_1se <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"1se\"]\nmn_min <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"min\"]\nmn_max_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), model_num]\nmax_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), posterior]  # used for drawing lines on graph\nsum_prob_ge_1se <- round(dt_post[model_num >= mn_1se, sum(posterior)], 5)\nsum_prob_le_min <- round(dt_post[model_num <= mn_min, sum(posterior)], 5)\nsum_prob_ge_1se_label <- paste(\"Pr(>= 1se) = \", sum_prob_ge_1se)\nsum_prob_le_min_label <- paste(\"Pr(<= min) = \", sum_prob_le_min)\npval <- list_primary$prior$list_prior_params$laplace_s_parameters[which(list_primary$prior$list_prior_params$prior_name == dt_post[1, prior_name])]\n\nggplot(data = dt_post, mapping = aes(x = model_num, y = posterior)) + \n  # max post line\n  annotate(\"segment\", x = mn_max_post, xend = mn_max_post, y=0, yend = max_post, colour = me_colours$teal, linewidth=1.5, linetype = 2) +\n  annotate(\"text\", x = mn_max_post, y = 1*max_post/3, label=paste(\"Max posterior model\"), colour = me_colours$teal) +\n  # 1se shaded box\n  # annotate(\"rect\", xmin = min(dt_post$model_num), xmax = mn_1se, ymin = 0, ymax = max_post, fill = me_colours$orange, alpha = 0.1)+\n  # annotate(\"text\", x = min(dt_post$model_num), y = 5*max_post/6, label=sum_prob_ge_1se_label, colour = me_colours$orange, hjust = 0) +\n  # min shaded box\n  # annotate(\"rect\", xmin = mn_min, xmax = max(dt_post$model_num), ymin = 0, ymax = max_post, fill = me_colours$red, alpha = 0.1)+\n  # annotate(\"text\", x = max(dt_post$model_num) + 2, y = 5*max_post/6, label=sum_prob_le_min_label, colour = me_colours$red, hjust = 1) +\n  # 1se line\n  annotate(\"segment\", x = mn_1se, xend = mn_1se, y=0, yend = max_post, colour = me_colours$orange) +\n  annotate(\"text\", x = mn_1se, y = 2*max_post/3, label=paste(\"lambda.1se model\"), colour = me_colours$orange) +\n  # min line\n  annotate(\"segment\", x = mn_min, xend = mn_min, y=0, yend = max_post, colour = me_colours$red) +\n  annotate(\"text\", x = mn_min, y = max_post/2, label=paste(\"lambda.min model\"), colour = me_colours$red) +\n  # posterior\n  geom_line(colour = me_colours$blue) +\n  labs(title = paste(dt_post[1, prior_name], \"prior - laplace scale is\", pval))+\n  coord_cartesian(xlim = c(50, 150)) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=768}\n:::\n:::\n\n\n#### Complex {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndt_post <- CalculatePosterior(list_primary$data, \n                         glmnet_obj = list_primary$glmnet_obj, \n                         varset = list_primary$varset$all,\n                         yvar = \"pmts\", \n                         dt_scaling_factor = NULL, \n                         list_filter = list_dt_filter_params$main, \n                         list_prior_params = list_primary$prior$list_prior_params, \n                         prior_name = \"complex\",\n                         scale = list_primary$scale)$probs\n\n\n# plot ----;\n# first get some quantities to put on the plot that we use in search for priors\nmn_1se <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"1se\"]\nmn_min <- list_primary$glmnet_obj$index[rownames(list_primary$glmnet_obj$index) == \"min\"]\nmn_max_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), model_num]\nmax_post <- dt_post[which(dt_post$posterior == max(dt_post$posterior)), posterior]  # used for drawing lines on graph\nsum_prob_ge_1se <- round(dt_post[model_num >= mn_1se, sum(posterior)], 5)\nsum_prob_le_min <- round(dt_post[model_num <= mn_min, sum(posterior)], 5)\nsum_prob_ge_1se_label <- paste(\"Pr(>= 1se) = \", sum_prob_ge_1se)\nsum_prob_le_min_label <- paste(\"Pr(<= min) = \", sum_prob_le_min)\npval <- list_primary$prior$list_prior_params$laplace_s_parameters[which(list_primary$prior$list_prior_params$prior_name == dt_post[1, prior_name])]\n\nggplot(data = dt_post, mapping = aes(x = model_num, y = posterior)) + \n  # max post line\n  # annotate(\"segment\", x = mn_max_post, xend = mn_max_post, y=0, yend = max_post, colour = me_colours$teal, linewidth=1.5, linetype = 2) +\n  # annotate(\"text\", x = mn_max_post, y = 1*max_post/3, label=paste(\"Max posterior model\"), colour = me_colours$teal) +\n  # 1se shaded box\n  # annotate(\"rect\", xmin = min(dt_post$model_num), xmax = mn_1se, ymin = 0, ymax = max_post, fill = me_colours$orange, alpha = 0.1)+\n  # annotate(\"text\", x = min(dt_post$model_num), y = 5*max_post/6, label=sum_prob_ge_1se_label, colour = me_colours$orange, hjust = 0) +\n  # min shaded box\n  annotate(\"rect\", xmin = mn_min, xmax = max(dt_post$model_num), ymin = 0, ymax = max_post, fill = me_colours$red, alpha = 0.1)+\n  annotate(\"text\", x = max(dt_post$model_num) + 2, y = 5*max_post/6, label=sum_prob_le_min_label, colour = me_colours$red, hjust = 1) +\n  # 1se line\n  annotate(\"segment\", x = mn_1se, xend = mn_1se, y=0, yend = max_post, colour = me_colours$orange) +\n  annotate(\"text\", x = mn_1se, y = 2*max_post/3, label=paste(\"lambda.1se model\"), colour = me_colours$orange) +\n  # min line\n  annotate(\"segment\", x = mn_min, xend = mn_min, y=0, yend = max_post, colour = me_colours$red) +\n  annotate(\"text\", x = mn_min, y = max_post/2, label=paste(\"lambda.min model\"), colour = me_colours$red) +\n  # posterior\n  geom_line(colour = me_colours$blue) +\n  labs(title = paste(dt_post[1, prior_name], \"prior - laplace scale is\", pval))+\n  #coord_cartesian(xlim = c(75, 200)) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){width=768}\n:::\n:::\n\n\n:::\n\n\n### Bayesian averaging of primary model path\n\nWe get a first initial estimate of model error by applying Bayesian averaging to the Lasso model path from the initial model.\nWe do this for each of the priors.\n\n\nFirst get the posteriors (basically rerunning the code above but putting it into the right object this time).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_fitted <- list_probs <- vector(mode = \"list\", length = length(list_primary$prior$list_prior_params$prior_name))\n\nfor(v in list_primary$prior$list_prior_params$prior_name){\n  tem <- CalculatePosterior(list_primary$data, \n                            glmnet_obj = list_primary$glmnet_obj, \n                            varset = list_primary$varset$all,\n                            yvar = \"pmts\", \n                            dt_scaling_factor = NULL, \n                            list_filter = list_dt_filter_params$main, \n                            list_prior_params = list_primary$prior$list_prior_params, \n                            prior_name = v,\n                            scale = list_primary$scale,\n                            return_fitted = TRUE)\n  list_probs[[v]] <- copy(tem$probs)\n  list_fitted [[v]] <- copy(tem$fitted)\n  \n}\n\nlist_primary$dt_probs <- rbindlist(list_probs)\n\ndt_fitted <- rbindlist(list_fitted)  # needed for scaling later on\n\n# factor prior_name to preserve ordering\nlist_primary$dt_probs[, prior_name := factor(prior_name, levels =list_primary$prior$list_prior_params$prior_name)]\ndt_fitted[, prior_name := factor(prior_name, levels =list_primary$prior$list_prior_params$prior_name)]\n```\n:::\n\n\n\nNow do the Bayesian averaging. We also need to get the posterior average cashflows by `acc` and `dev` for use in the bootstraping filtering step - when applying the inclusion gates we do it relative to the posterior cashflows for that particular prior.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run the Bayesian averaging\nlist_primary$dt_results <- SummariseBayesianAveraging(list_primary$dt_probs)\n\n# Primary posterior forecasts\nlist_primary$dt_posterior_forecasts <- GetPosteriorForecasts(dt_fitted, list_primary$dt_probs)\n```\n:::\n\n\n\n### Results\n\nFinally display the results.\n\n- `post_cov` is our initial estimate of internal model structure error - but limited since the model set is sparse\n- `post_cov_pe` adds on process error (we sample each future fitted value from a gamma distribution determined by the cell mean and the scale parameter)\n  - However this is not particularly reliable here since we don't have enough observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# display table of results\nlist_primary$dt_results |> \n  datatable() |> \n  formatRound(c(\"post_mean\", \"post_sd\", \"post_mean_pe\", \"post_sd_pe\"), digits=0) |> \n  formatPercentage(c(\"post_cov\", \"post_cov_pe\"), digits=2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-3ddc33c2e75fa89e0a7a\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3ddc33c2e75fa89e0a7a\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\"],[369197.815593136,367889.12244492,371718.312096037,420792.021411331],[7527.10115461685,439.111987248421,9069.4890146685,9426.07863433804],[0.0203877185527877,0.00119359872433892,0.024398822225162,0.02240080171369],[366576.07673013,367160.268009327,371654.411853531,421425.630899085],[9742.54575583272,5700.40403551645,10654.9269686847,10391.2504723678],[0.0265771455757193,0.0155256560477607,0.0286689102264277,0.0246573765582286]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>prior_name<\\/th>\\n      <th>post_mean<\\/th>\\n      <th>post_sd<\\/th>\\n      <th>post_cov<\\/th>\\n      <th>post_mean_pe<\\/th>\\n      <th>post_sd_pe<\\/th>\\n      <th>post_cov_pe<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\",\"options.columnDefs.5.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n\n## Bootstrap\n\nNow we move onto the bootstrap. The process is described in Section 6.2 of the paper. In less formal language the steps are:\n\n1. Generate $B$ pseudo data sets using a semi-parametric bootstrap. By this, I mean that we start with the lambda.1se fitted values, randomly sample the residuals (with replacement) $B$ times and generate $B$ pseudo data sets by combining the fitted values with each of the $B$ samples\n2. Fit a Lasso model to each using the set of lambda values used in the primary model\n3. For each bootstrapped sample, produce the liability estimates and posterior probabilities. Since we will centre the bootstraps around the posterior forecasts (next point), which in turn will change the posteriors, use wider inclusion gates to avoid eliminating bootstraps on the boundary of acceptability\n4. Calculate the scaling factor required to scale the sample mean of the posterior means from each pseudo data set to the original posterior means\n5. Filter the results based on the normal inclusion gates\n6. Recalculate the reserves and posterior probabilities\n7. Drop any bootstrap replication $b$ which has fewer than 5 models with a posterior probability of at least 0.0001.\n\n\nIn terms of R code, I've wrapped all this up in a single function (consisting of a number of other sub-functions) - `ParallelBootstrap()`. So you'll need to refer to the function file for the details there. \n\n\n### Semi-parametric bootstrap and first round of calculations\n\nHere we do steps 1-3 from above.\n\n\nAs with the primary model, we'll make a list to hold all the results from the bootstrapping\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_bs <- list()\n```\n:::\n\n\n\nThe time-consuming part of this process is fitting the Lasso models. In the [_functions.R](./_functions.R) file, the `BootstrapBatch()` is the actual workhorse function that does the bootstrapping. `ParallelBootstrap()` is a wrapper around it which gives the option of running the code in parallel to speed things up. For example, to produce the numerical results in the paper, I ran 10 parallel processes on a linux machine and it took about 72 minutes.  \n\nNote that the parallelisation currently only works on linux since I've used forking. If you want to run parallel code under windows you will need to edit the `ParallelBootstrap()` function to handle sockets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- ParallelBootstrap(dt = list_primary$data,\n                       nboot = num_bootstraps,\n                       scale = list_primary$scale,\n                       resid_name = \"resid\",\n                       var_pred_name = \"var_pred\",\n                       min_val = 10,\n                       vec_lambda = lambdavec,\n                       list_varset = list_primary$varset,\n                       yvar = \"pmts\",\n                       dfmax = dfmax_default,\n                       pmax = pmax_default,\n                       thresh = 1e-7,  # higher threshold speeds things up a bit\n                       list_prior_params = list_primary$prior$list_prior_params,\n                       dt_scaling_factor = NULL,\n                       list_filter = list_dt_filter_params$initial,  # wider gates\n                       parallel = use_parallel,   # TRUE for parallel, only works on linux\n                       nworkers = num_workers,    # set to number of parallel processes\n                       batchsize = batchsize\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Time taken: 3.7992 mins\"\n```\n:::\n\n```{.r .cell-code}\nlist_bs$list_glmnet <- x$list_glmnet\nlist_bs$dt_unscaled_probs <- x$dt_probs\nlist_bs$dt_bs_data <- x$dt_bs_data\n\nlist_bs$dt_unscaled_results <- CalculateModelError(list_bs$dt_unscaled_probs, min_model_number = 5, min_model_prob_threshold = 1e-4)$results\n\nrm(x)\ngc()  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 2526149 135.0    4438395 237.1  4438395 237.1\nVcells 9087459  69.4   17860456 136.3 17860456 136.3\n```\n:::\n:::\n\n\n`ParallelBootstrap()` returns a list with three elements:\n\n- a list of all the fitted Lasso models, one for each bootstrap\n- a data.table of the posterior probabilities for all the models that survive the filtering\n- a data.table of all the pseudo data sets.\n\n\nI've calculated results after this initial round. This is to facilitate the scaling (next step), other than that we don't use these results\n\n\n### Scaling factors\n\n- Calculate factors so that the posterior bootstrapped means will match the means from the primary model (step 4 above)\n- Note, however, that we don't expect to get exact matches after scaling. This is because the scaling will lead to some changes in the posterior calculations, and possibly even the included bootstraps\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# combine bootstrap means and primary posterior means and get scaling\nlist_bs$dt_scaling <- list_bs$dt_unscaled_results[ list_primary$dt_results[, .(prior_name, post_mean)], \n                                          on=.(prior_name), \n                                          primary_post_mean := i.post_mean][, .(prior_name, primary_post_mean, bs_means_mean)]\n\nlist_bs$dt_scaling[, scaling_factor := primary_post_mean / bs_means_mean]\n\n# print out the scaling factors\nlist_bs$dt_scaling |> \n  datatable() |> \n  formatRound(columns = c(\"bs_means_mean\", \"primary_post_mean\"), digits=0, mark=\",\") |> \n  formatPercentage(columns = c(\"scaling_factor\", \"scaling_factor\"), digits=2) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-cd0039bc9c4bf312c313\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cd0039bc9c4bf312c313\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\"],[369197.815593136,367889.12244492,371718.312096037,420792.021411331],[383280.762232415,367273.320199922,367255.475121649,363739.595993179],[0.963256839301682,1.00167668657408,1.0121518596092,1.15684964201484]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>prior_name<\\/th>\\n      <th>primary_post_mean<\\/th>\\n      <th>bs_means_mean<\\/th>\\n      <th>scaling_factor<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Rescale the bootstraps\n\nWe now carry out steps 5-7 above. When calling `ParallelBootstrap()` this time:\n\n- The input data is the data.table containing all the pseudo data sets\n- I use the argument `list_glmnet` to pass in the list of fitted Lassos. This tells the function not to actually refit the Lasso models. Instead, it just scales the past fitted values for the scaling factor (for the likelihood) and adjusts the intercept term in all the models by the scaling factor (for the prior and the reserve predictions). \n- I also use the main inclusion gates rather than the wider ones.\n\nThe function then carried out steps 5-7 and we get a table of all retained bootstraps and the posterior probability of each model. We can then calculate the model error with the `CalculateModelError()` function.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- ParallelBootstrap(dt = list_bs$dt_bs_data,\n                       nboot = num_bootstraps,\n                       scale = list_primary$scale,\n                       resid_name = \"resid\",\n                       var_pred_name = \"var_pred\",\n                       min_val = 10,\n                       vec_lambda = lambdavec,\n                       list_varset = list_primary$varset,\n                       yvar = \"pmts\",\n                       dfmax = dfmax_default,\n                       pmax = pmax_default,\n                       thresh = 1e-7,\n                       list_prior_params = list_primary$prior$list_prior_params,\n                       dt_scaling_factor = list_bs$dt_scaling,\n                       list_filter = list_dt_filter_params$main,\n                       parallel = use_parallel,\n                       nworkers = num_workers,\n                       batchsize = batchsize,\n                       list_glmnet = list_bs$list_glmnet )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Time taken: 2.8138 mins\"\n```\n:::\n\n```{.r .cell-code}\nlist_bs$dt_probs <- x$dt_probs\n\ntem <- CalculateModelError(list_bs$dt_probs, min_model_number = 5, min_model_prob_threshold = 1e-4)\nlist_bs$dt_results <- tem$results\nlist_bs$dt_retained_bs <- tem$retained_bs\n\nrm(x, tem)\ngc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 2526368 135.0    4438395 237.1  4438395 237.1\nVcells 9627279  73.5   21512547 164.2 17860456 136.3\n```\n:::\n:::\n\n\n\n\n## Results \n\nFinally we can look at some results. I've shown results for all priors here, but, as per the paper, we consider the lambda.1se and the lambda.min priors the appropriate ones to choose between. In both of those all bootstraps are retained (same is true for simple), but many are filtered out for the complex model - and, based on the CDF graphs, it is inappropriate to use it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# used to format tables\n\npercent_cols <- c(\"bs_covs_mean\", \"bs_variances_cov\", \"bs_means_cov\", \n                  \"cov_model_param_process_error\", \"cov_model_error\", \"cov_param_error\", \"cov_process_error\")\npercent_cols <- c(percent_cols, paste0(percent_cols, \"_pe\"))\n```\n:::\n\n\n\n::: panel-tabset\n\n### Grand results {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrand_results_cols <- c(\"cov_model_param_process_error\", \"cov_model_error\", \"cov_param_error\", \"cov_process_error\",\n                        \"bs_means_mean\", \"num_bs\",\n                        \"sd_model_param_process_error\", \"sd_model_error\", \"sd_param_error\", \"sd_process_error\")\n\n\nkv <- c(\"prior_name\", grand_results_cols)\nkvpc <- intersect(kv, percent_cols)\n\nlist_bs$dt_results[, ..kv] |> \n  datatable() |> \n  formatRound(columns = setdiff(kv, c(\"prior_name\", kvpc)), digits=0, mark=\",\") |> \n  formatPercentage(columns = kvpc, digits=2) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-9df27dea6a8069accdbc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9df27dea6a8069accdbc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\"],[0.0336783134697227,0.0335211727318699,0.0496030270244172,0.0510451030672734],[0.0115842107626644,0.00519290234549049,0.0115802341327181,0.0148154813682755],[0.0312763579226656,0.0328414838725559,0.0481221926375483,0.0487961912857729],[0.00467164791742607,0.00425907543942402,0.00325776659249608,0.00224405324738681],[369190.29937366,367765.067523721,370859.165189624,380006.861917315],[100,100,100,41],[12433.7066322869,12327.9163532104,18395.7371931537,19397.4894328405],[4276.77823947563,1909.7680817334,4294.63596316021,5629.98458255282],[11546.9279447867,12077.9505339697,17846.5561886554,18542.8875240236],[1724.72709320287,1566.3391665684,1208.17259887574,852.755632514824]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>prior_name<\\/th>\\n      <th>cov_model_param_process_error<\\/th>\\n      <th>cov_model_error<\\/th>\\n      <th>cov_param_error<\\/th>\\n      <th>cov_process_error<\\/th>\\n      <th>bs_means_mean<\\/th>\\n      <th>num_bs<\\/th>\\n      <th>sd_model_param_process_error<\\/th>\\n      <th>sd_model_error<\\/th>\\n      <th>sd_param_error<\\/th>\\n      <th>sd_process_error<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":8,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":9,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":10,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":11,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9,10,11]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\",\"options.columnDefs.5.render\",\"options.columnDefs.6.render\",\"options.columnDefs.7.render\",\"options.columnDefs.8.render\",\"options.columnDefs.9.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Underlying table {.unnumbered}\n\nGrand results taken calculated from this\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkv <- setdiff(names(list_bs$dt_results), grand_results_cols)\nkvpc <- intersect(kv, percent_cols)\n\nlist_bs$dt_results[, ..kv] |> \n  datatable() |> \n  formatRound(columns = setdiff(kv, c(\"prior_name\", kvpc)), digits=0, mark=\",\") |> \n  formatPercentage(columns = kvpc, digits=2) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-07dcb62a494b3e1065e1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-07dcb62a494b3e1065e1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\"],[19682502.2626424,7474058.12810192,25307015.3143159,40633179.2851858],[133331544.962095,145876889.101019,318499567.794836,343838677.72859],[0.0115842107626644,0.00519290234549049,0.0115802341327181,0.0148154813682755],[369435.928265129,367901.338624194,370979.242185888,379970.664247703],[47116158.8549289,32764646.4257323,49191897.556337,65042126.3354125],[140023123.123448,144915509.317311,321416820.595012,336794160.864078],[0.0179579496626199,0.0149397331071011,0.017929358317157,0.0203294183293683],[245.628891468931,136.271100472953,120.076996263656,-36.1976696125088],[2974683.54602801,2453418.38472618,1459681.02867417,727192.168785758],[0.0120168287950862,0.00743374673147791,0.0135647391775451,0.0167744760277635],[0.0312763579226656,0.0328414838725559,0.0481221926375483,0.0487961912857729],[0.0185800042780761,0.015558630783059,0.018905892235716,0.0212249803692612],[0.0320302811687326,0.0327209621686974,0.048326427420289,0.0482983404641457],[0.00467164791742607,0.00425907543942402,0.00325776659249608,0.00224405324738681]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>prior_name<\\/th>\\n      <th>bs_variances_mean<\\/th>\\n      <th>bs_means_variance<\\/th>\\n      <th>bs_covs_mean<\\/th>\\n      <th>bs_means_mean_pe<\\/th>\\n      <th>bs_variances_mean_pe<\\/th>\\n      <th>bs_means_variance_pe<\\/th>\\n      <th>bs_covs_mean_pe<\\/th>\\n      <th>bs_means_mean_diff_pe<\\/th>\\n      <th>bs_means_variance_diff_pe<\\/th>\\n      <th>bs_variances_cov<\\/th>\\n      <th>bs_means_cov<\\/th>\\n      <th>bs_variances_cov_pe<\\/th>\\n      <th>bs_means_cov_pe<\\/th>\\n      <th>bs_means_cov_diff_pe<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":8,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":11,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":12,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":13,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":14,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":9,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":10,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":15,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\",\"options.columnDefs.5.render\",\"options.columnDefs.6.render\",\"options.columnDefs.7.render\",\"options.columnDefs.8.render\",\"options.columnDefs.9.render\",\"options.columnDefs.10.render\",\"options.columnDefs.11.render\",\"options.columnDefs.12.render\",\"options.columnDefs.13.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Individual bootstrap results  {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# calculate posterior means, variances\n\nlist_bs$dt_idv_results <- list_bs$dt_probs[,`:=`(bs_post_mean = sum(reserve * posterior), bs_post_mean_pe = sum(reserve_pe * posterior)), \n                                             by=.(boot, prior_name)\n                                          ][, .(bs_post_mean = mean(bs_post_mean),\n                               bs_post_mean_pe = mean(bs_post_mean_pe),\n                               bs_post_var = sum( ((reserve - bs_post_mean)^2) * posterior),\n                               bs_post_var_pe = sum( ((reserve_pe - bs_post_mean_pe)^2) * posterior)    ), \n                           keyby = .(boot, prior_name)]\n\n\n# add sd and cov now\nlist_bs$dt_idv_results[, `:=`(bs_post_sd = sqrt(bs_post_var), \n                           bs_post_sd_pe = sqrt(bs_post_var_pe),\n                           bs_post_cov = sqrt(bs_post_var) / bs_post_mean, \n                           bs_post_cov_pe = sqrt(bs_post_var_pe) / bs_post_mean_pe)]\n\n\ndatatable(list_bs$dt_idv_results, options = list(pageLength = 12, lengthMenu=c(12, 20, 40, 100))) |> \n  formatRound(columns = setdiff(names(list_bs$dt_idv_results), c(\"boot\", \"prior_name\", \"bs_post_cov\", \"bs_post_cov_pe\")), digits=0, mark=\",\") |> \n  formatPercentage(columns = c(\"bs_post_cov\", \"bs_post_cov_pe\"), digits=2) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-7a642c7357e78980a1ca\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7a642c7357e78980a1ca\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\",\"334\",\"335\",\"336\",\"337\",\"338\",\"339\",\"340\",\"341\",\"342\"],[1,1,1,2,2,2,3,3,3,4,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,11,12,12,12,12,13,13,13,14,14,14,15,15,15,16,16,16,16,17,17,17,18,18,18,18,19,19,19,20,20,20,21,21,21,21,22,22,22,22,23,23,23,24,24,24,25,25,25,25,26,26,26,26,27,27,27,28,28,28,29,29,29,29,30,30,30,31,31,31,31,32,32,32,33,33,33,34,34,34,35,35,35,36,36,36,36,37,37,37,38,38,38,38,39,39,39,40,40,40,41,41,41,41,42,42,42,43,43,43,44,44,44,45,45,45,45,46,46,46,46,47,47,47,48,48,48,48,49,49,49,49,50,50,50,50,51,51,51,51,52,52,52,53,53,53,53,54,54,54,55,55,55,56,56,56,56,57,57,57,57,58,58,58,59,59,59,60,60,60,61,61,61,62,62,62,63,63,63,63,64,64,64,65,65,65,65,66,66,66,66,67,67,67,67,68,68,68,69,69,69,69,70,70,70,70,71,71,71,72,72,72,73,73,73,74,74,74,74,75,75,75,75,76,76,76,77,77,77,78,78,78,78,79,79,79,80,80,80,81,81,81,82,82,82,82,83,83,83,83,84,84,84,84,85,85,85,86,86,86,86,87,87,87,88,88,88,89,89,89,89,90,90,90,90,91,91,91,92,92,92,93,93,93,93,94,94,94,94,95,95,95,96,96,96,97,97,97,98,98,98,98,99,99,99,100,100,100,100],[\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\",\"simple\",\"lambda.1se\",\"lambda.min\",\"simple\",\"lambda.1se\",\"lambda.min\",\"complex\"],[375539.19726035,374902.991712725,378229.605249097,358504.940139056,358291.817781011,377786.857300684,386389.849826041,377936.868400421,371418.764239132,369345.88683106,363255.82162932,344314.461746089,358747.682928182,347208.566956539,340339.905345976,387217.982196754,360217.007498659,358188.694735619,361222.659131901,375770.930811439,368031.5224209,363021.840216956,386596.974887642,386127.403307073,405469.620040399,360436.940111945,356204.803641215,366825.707121021,364485.504408281,362385.196685043,381476.754236856,346733.275350573,343843.300505566,362329.977675046,368005.506722334,396434.934306328,394115.358809147,365441.766817868,382481.568155316,368294.67850872,368622.438570159,370880.868167509,358826.232909332,359322.674734807,381210.354799304,373253.268539585,373694.825928891,391977.003161595,356249.441232433,354153.981769255,345744.635936326,374014.099415418,393144.300915422,392550.909165059,397298.207758476,375617.435062834,385189.11621812,365767.963856238,382267.802930313,386300.942634853,384073.303899587,376737.020660303,359866.792474723,359326.285972341,356046.444358927,356622.778550529,348455.409796491,345222.085079028,412343.475799537,364578.386525102,360218.007280987,349790.844409197,348844.640284827,354291.89389903,363067.042934485,375696.433476061,365377.951695723,363588.748877904,357927.91538767,358787.275096037,354391.051763188,353279.73038942,388987.384257594,361799.034244353,358144.198478743,345964.298582601,379045.926821838,386771.507499229,381787.074973312,411197.847338848,376982.040748535,370159.597013598,380674.528000021,350384.266477878,348509.485934359,346216.777453303,400473.055364073,389718.488211463,386236.08180551,398892.520484493,349947.6326612,355163.009842551,364871.657292079,400051.648179591,371637.819586383,366694.10186832,376982.230349771,384613.720772668,382556.919038865,378455.181654065,372481.123630458,370138.354543434,371396.636774555,377556.233451624,378548.703785773,399384.13441416,359394.814287778,354331.978952546,354239.975333809,370872.825597699,373168.832737759,382103.093821649,398109.821204368,380774.999251262,374749.471849103,350013.88975495,344707.371198298,395702.977715175,393639.906536467,404932.504517797,374453.029453842,380555.320426821,398053.910437594,366342.703096722,355674.900595976,333077.02696212,347138.622108751,371891.206830804,365992.715357382,376975.686784264,371089.445036711,375945.129122493,375350.465025686,365432.733299839,359371.950211353,359534.949183398,353650.281237229,343492.200072847,344916.225669371,386120.46852738,371010.475170955,365820.763023947,360086.540471746,392590.117556835,373593.638655006,374521.241202651,410263.899574003,368146.435565811,367732.995949693,358273.841265979,368385.967302678,367576.861051464,366165.220650289,353366.141734607,403508.470651507,353263.11049619,362046.564789019,349792.561935455,421325.730660883,366961.221793475,359030.822243346,362010.503953538,381443.787710297,370864.916792261,367331.039091958,404162.837692158,379847.016153762,375398.537939754,369011.088473896,385686.205359627,377611.546673802,373579.078904351,389146.815993883,378788.017423871,376247.663609024,366659.867026709,361924.182886797,359766.039315715,361331.738574257,381002.502969718,364663.215868214,364106.473449139,363218.219573046,373247.023074637,377704.40293909,376209.644390764,377479.802254111,376323.385206038,378468.886006461,383252.643724,383941.444943892,379544.167664461,382981.85912629,383408.651246069,382153.755061975,382813.522752321,373501.364610775,371790.587859706,389591.00938774,378287.570390382,372229.351726058,362622.818951787,356913.682263931,371994.946204892,370924.195530825,383430.826001343,364302.509324777,369185.966123776,348031.294547606,394616.941256023,362703.029853269,367432.038262137,372967.381620855,385917.923277237,347000.154424207,342719.81991818,335884.785885334,397774.633690722,369354.175197143,363304.781612086,365128.079549875,376250.998997707,377633.26899521,381999.038667381,366286.876722643,380955.25993601,379340.820553113,377853.45256445,374348.553127785,379200.686990446,381147.97667122,387487.781304964,359876.11074149,353733.103123151,373764.230719065,359085.798467106,372974.746548632,373102.475195695,367508.47009741,362379.05368506,346199.727272639,347250.899268395,357078.893514634,353326.456373966,338771.051926802,362033.424296782,370716.843261861,373399.249796749,373914.799372419,377414.09247149,371959.222739011,367507.966947936,387380.259078653,394743.34339531,368138.376027896,374890.975992996,373441.399758645,367861.192290388,365784.163023973,365210.601880129,360723.652633705,375307.772295058,357632.031159806,358320.673324346,390311.937064611,384220.147783579,379295.381008454,355604.601377338,390938.390520636,351972.39442208,350845.344301511,350556.469100572,404713.105403084,345100.247846226,341734.55316525,367100.082242289,398568.535272118,358382.242570699,355516.609076106,364324.599746018,352058.283518051,352830.44929145,372762.985680139,380326.886480813,359974.789601157,359721.077541879,382955.25693571,357347.255366133,361895.454138183,388686.343751401,365844.83229245,369495.45636313,362398.876341958,390701.631023114,373380.661377887,371192.780175513,350554.317275029,380253.284381957,376821.257100873,375284.440915872,396016.561820458,360089.826808158,360747.116135914,387894.745409961,368760.63877355,368049.304029274,342589.863286038,391916.637591741,370709.375255233,374260.087745344,375810.882211441,350814.126379213,386870.979984447,380460.632939884,392968.423341471,366093.682183986,365365.140868922,364302.02732209,359815.614025186,360484.591771266,363217.192475062,374675.021263256,383673.732253015,357238.271257591,399575.032589882,361425.583408795,362322.170580347,399066.116807707,378295.10789358,376008.359499183,358642.279497576,375764.856749544],[374720.475139129,374403.307720944,377894.616572914,356688.80684574,358864.113846152,379934.120370889,387008.307665607,379591.509038427,370732.17589096,370325.27489869,363599.315658005,344198.957242863,358093.194419111,348722.927665513,340244.080164201,386875.328641222,362319.724402566,358304.15737731,361427.826964356,376349.469394762,372017.346457918,364350.372230605,386978.96449871,388248.191551171,403321.523662384,358903.342146126,355485.844568386,366873.576390449,364165.438213234,365439.260576402,381643.381095399,348092.415046448,344582.20899907,363255.314350487,368046.627775425,400491.87254926,391762.535180635,365156.455101588,382900.832585815,368149.671611143,365174.43744719,371143.317639107,357990.431417466,360919.495258714,379868.024205082,375084.121690545,372195.770373584,392814.290554823,355907.566274088,355282.336734657,344049.713378978,373620.207826925,392490.089081974,393146.707310466,395075.008998354,375915.219985861,387366.165260712,365923.606195434,381932.693346159,384864.48653938,385699.359095441,377792.900880622,358287.620282198,358590.292971089,356738.788920688,353009.933547589,346922.341373074,343443.182495861,412864.728929764,364803.249739267,361063.323925336,351357.819338121,349297.517042298,354448.044219522,362985.055328508,375533.764213104,363266.772540707,362847.197794512,357107.90220013,359291.030160434,351777.408813855,352619.681763142,389291.300827914,362902.201196008,358085.256327588,347285.568598198,378662.55640903,385856.044134185,380239.725882484,415550.209559296,376276.277796908,371576.303825629,380368.863572474,349871.510594925,349752.7636969,346192.277967537,399854.282985041,391701.430179165,383681.51303022,399073.383873174,348974.110914632,353624.337084907,365423.117260731,400805.061851157,371933.060293606,367123.423485201,377776.397017337,384911.683089681,384526.235976108,377846.437858525,376133.455773962,369677.361541305,372286.740573088,380001.893967064,377675.291755125,400925.953207035,363074.416323912,356904.906025117,356018.252272791,371477.82399961,371791.476164346,381268.886312393,398316.341613873,380041.405518854,377664.620360354,351535.156489056,344727.210622197,396043.737404131,391527.287118227,403969.508252003,377770.306867223,381573.870237395,397681.467693277,364274.307024,357450.449035421,333378.482415278,347372.027986542,373878.211296074,364741.439710437,375983.425195277,370777.278350529,373678.610563435,374987.341384041,365140.907635248,358853.176264727,359874.829892829,352506.196217668,346160.654132864,346953.11237767,386175.426180626,369890.911997431,366614.22633099,361990.898114382,392118.424681802,372691.237181735,375479.135331693,408973.584568983,366075.690013648,368231.034299023,360085.113293738,368199.076316917,367121.800029374,366583.725190983,353656.231559133,402013.243369938,352177.469832924,361845.46118991,349535.817273681,418143.267268353,368136.641425677,357584.026854027,363468.415691764,381282.094958976,373251.660992591,367750.672029239,405739.334459307,381584.497763966,375989.170704417,368270.875431909,387946.659574825,376425.531949334,375071.067976071,389003.626939436,383911.264777204,375756.215082891,365661.185876729,359830.967218232,360511.994192036,360004.78153104,380503.629960909,367096.030451594,364820.145865933,364236.163238589,372875.359299585,378964.15384132,378075.960496423,379233.286363335,379651.697910894,377702.468779894,384931.762857426,386536.816285154,381240.033384078,383590.90326455,381725.574036207,382244.03169119,384103.463670899,375148.661238898,369709.746652781,389007.874512707,375948.225238308,373630.858688409,363317.911690006,356752.437695329,372224.623440476,367388.724960982,384656.775618933,362248.163631437,368721.229254511,346874.626173842,395377.018294844,361191.678186935,366518.230667589,373448.298942165,385235.930054203,347069.986051489,345679.225454383,334805.846112506,398793.266428454,370850.601210476,361946.617497438,365159.072171291,374923.133720291,376605.387710119,384547.968830533,365748.286960427,380057.441155994,380110.408578629,376687.280310131,375060.702199699,379414.740605874,384067.890697755,387833.640832271,359287.209980882,352384.787011219,372274.370943474,360064.022809814,371351.828710773,373135.2429226,367904.190283075,365605.736482905,345993.213418421,348009.041574456,356362.753975947,352974.515194332,339642.649021183,361426.006661032,368175.278426039,374087.387545835,373492.296243328,376120.838003118,373555.719969835,365478.963850682,385818.763810967,393084.388057861,368623.631095844,374814.712463214,375405.326568797,368487.715432089,367276.762428713,366652.156511846,359270.072053695,375450.456806194,359914.971782734,358121.473833545,390656.806637926,385634.857454556,379037.003113557,355913.717035187,391650.344429717,351756.309115979,350618.342604795,349957.956020778,405240.481921607,346639.137313772,342429.845315649,365419.498229606,398566.400974262,358239.914749432,355275.024857599,366715.74195776,354250.164430795,354214.839899375,371091.103003443,380677.664682132,361071.45436847,357940.556490842,383369.026177979,360205.013512041,360646.963481344,388680.926640609,366340.035629223,366652.589842942,359995.941374817,390119.696714934,377018.193693112,371577.389830062,348496.264153944,380804.885980886,377684.705921774,378342.650036254,397033.916499592,361697.136101256,359805.567883763,388269.629139888,368814.280567759,368422.772531774,341881.553247922,390459.70875453,368740.724472649,375486.283461328,374295.99649936,351082.007045982,385177.450979551,380896.276381118,392151.485083606,366060.824203267,364779.149070561,364517.371249234,356767.002372259,360915.30619513,363876.610955887,374738.850859733,382363.766327608,358123.240356073,399397.094050766,360759.995886683,363199.338224264,398268.71815725,380006.896241823,376431.007826312,358457.87373712,376755.317345263],[18307691.0678614,440422.51886402,6884171.96218551,15862095.6495565,509605.761816101,76531194.6568252,13748802.5828627,937944.559566629,2978228.19871788,31220331.2000322,126209.435158551,27822344.2825786,11235264.7645539,11995879.3218735,302744.801824148,70095651.183461,13652487.4423796,283953.83826969,3987465.2302607,16860633.3353392,411016.572366504,5953207.36508812,40185781.3944176,218219.237059214,22153282.3232413,35540105.2438127,184521.802749811,1242979.37642322,13355724.0097501,317569.042099852,25377542.2952371,11876594.7456452,23347020.5985979,11889929.8362204,144114209.780262,15060523.7214322,63022.2041421838,18172804.4617573,11672976.1682315,14577852.1721908,2568341.44038542,4986822.64600151,13097343.3352564,14995666.4493021,33297251.1410981,17437735.4611593,909360.734445,9420844.93976768,12988787.0813121,8135802.89376229,58462691.7182016,10337276.2678634,11942388.2330647,1614738.04340237,2074933.56275396,13356888.3955435,20002171.6348193,1098596.44616534,22626225.0252346,14485816.5542383,154979.733231033,44272166.9006763,18095448.4010474,51840.4886761285,2526735.38139859,20706833.189604,256729.123046701,22731717.4193655,46586126.7572656,21290736.6107371,1896060.45079724,2821524.19571207,97136538.1723735,51389876.4884156,76000.821028608,16911322.2380198,13172363.7846288,387098.652104064,4963429.26670095,12745472.7912468,661727.797199367,13027856.5937119,26559624.0832987,22428884.6873047,526650.990664253,4827284.85520753,13097573.2074072,12702282.0086302,1972476.57959532,3533640.66033612,15218194.8886474,258082.929001607,17634838.0825234,12820177.7699674,82988.5729642958,2330062.27451102,3751315.28323038,19009781.6206564,186522.047020376,24808691.1518355,18797842.7996891,41614866.0575744,177564937.523678,31246967.9152855,25711327.0038115,264510.959054395,3125649.01622145,18074409.2091643,28880339.8191752,5150267.58122923,14179748.4762345,170719.736563328,6227664.55245762,36646584.5272528,183359.777994473,38054091.6205689,54232492.1656836,730825.515894894,84008028.5344838,53184291.533226,13487910.4561617,7100450.1159379,17227387.3201489,13740850.6723626,1040427.0247107,28697544.3867947,176630368.01127,18531835.7688921,474237.782379633,2892213.68200113,14032589.8684787,26323723.4390179,23466672.1415471,16729444.9075374,5384888.83194494,16190669.4020603,18383708.7746261,79637505.7689189,2086790.72685565,19050800.0616498,17780834.6455189,41523524.6585603,1593530.37144928,16521370.1983334,3134475.39798593,4845034.99001973,12506070.7293855,159396.405300409,3438854.29599597,45120557.553452,18794911.7763761,29026005.4613103,32585001.6937576,26086720.9033323,30492320.0937876,192964.305661443,45096894.8153909,14323993.6473037,219111.03651051,34376687.4026967,43736574.5668618,13847126.2194299,64890590.1524691,33263973.6816611,30445814.1509147,13013963.8146222,14796507.4260408,20541820.1734096,39544162.6795754,16735764.7738794,7425.75758494494,2304287.2544637,70594988.2520081,15381176.7795028,188822.862260218,88079501.9947837,17526589.6341226,4528993.57552582,20339333.6523106,4052635.73696064,17498379.6128852,3495417.61148903,5936874.27671188,18079033.4176966,22620901.8499932,5596145.22871424,13106383.7419069,259356.92832491,28521702.4274813,9402963.67405627,18899491.8029496,24041117.8794585,10447508.0149785,2795529.24478841,13221596.0157954,1885952.46178324,2760606.41783446,13675214.6824195,45001716.9037876,24718013.8144337,17494195.1314721,1867628.19020585,5531277.79120029,18365436.4862473,36199895.3478073,6174021.83030661,17381890.7818682,2158017.30764475,5240305.85267736,13405368.4456575,6116899.91548967,22935805.81281,42708408.2785057,13068804.3641083,1406612.77053024,7574376.03856114,14078097.36053,56356733.2727863,7286124.34181998,353.970155775417,34621375.7796675,139570.240572094,34244964.324849,32300255.1528141,11468108.5013872,995338.210807467,12551708.6221741,2792184.1108663,14039825.460905,858889.632637231,3015571.92285858,13143716.835583,2942381.15182623,9909160.94237229,114687924.650917,13031587.9694488,11148701.6569281,91082658.9027548,27533227.4198625,12585558.9824803,13691121.9702119,12694003.1316965,12306822.0559636,54071.0015340675,80109820.7049801,23973195.8822964,327036.727242326,2419966.23491929,13708728.3680692,555025.174897587,5987086.17026946,166116128.428206,14858127.4579636,14265624.6441757,31234044.4535505,12116687.0471367,15734016.3501389,178607.026318525,17641937.8839643,14241828.3179027,3901624.24493511,6786987.00464884,14624501.1828995,29232696.072738,106429662.071459,9809268.46498559,18942860.3649989,6302219.16012386,4739909.663086,13160468.892274,13727072.8149762,10892508.6990549,12699773.9663387,7082014.86857542,87898462.7566149,13905491.8962711,328711.732438131,19370062.9818956,19863932.9518553,74413077.6752261,67729.5793418531,6221492.18770126,18674272.0872982,23903441.8712816,29243.5969346406,125729454.051292,11143450.6986082,20945927.3094692,80959.1736750271,3534867.81147008,11946198.4563365,298841.837212436,53517693.1535955,8847532.01423804,13231594.6185357,4419558.99704336,21050268.5114959,10464121.4822587,23547744.6833669,95853712.4830518,13608632.0805292,4701045.92449118,40939555.653285,1313841.98767087,12755026.6192389,12185171.5240832,9835741.77517769,11058959.5791693,13886529.1757717,335998.500861024,16805674.9248241,36657215.5564858,54106.367770372,103562368.280191,13420722.0629133,4586526.21741045,14579367.8174588,5590793.27494205,115821382.327841,103045.740684044,40071317.9269763,63742701.4194787,14653733.5743025,180976.96470552,16798984.5954387,13235764.4506113,1116054.60754944,1146001.15086845,14198333.7157752,299528.674789564,7916536.9328413,17503662.5052063,23129555.5728571,19426413.9890529,42722539.9181672,12581978.5240601,9955697.25433558,27776598.3859033,13842827.0252036,370624.242567965,5264146.6875284,136595830.701818],[25146480.6189427,11686496.990646,32678287.9677578,35462638.0513031,17332848.6452089,90179872.7987575,40799384.763182,84576321.2100224,29337180.1748125,49255938.3959273,23180470.1526243,80890679.358713,35254549.3252788,50906649.7610248,11966099.065333,116294126.161134,36194928.7450927,21033596.8038858,33550573.5357421,24099373.0020895,29640553.6385678,21327379.7864351,100576903.806353,12573967.8193375,41257011.6612431,102728563.193174,22075288.5833357,31285723.1014973,33527790.0266487,14721871.2099499,43836434.5223863,31610421.3624835,40343099.1459424,30414235.3465649,194169641.363784,61826660.1482866,15484190.4879564,36879167.4380572,45583075.4243796,35711424.6423335,10305930.9047808,28749383.3547248,34495982.1182187,51045883.2483567,55029168.1742486,39528603.0159661,45704166.3855613,49606367.7168925,118980569.270466,31743047.6545662,59282849.5562705,36981334.2972691,11133180.2154149,96677422.295666,13838028.2675261,65938813.8603876,38224047.9412438,22896910.6465621,50639801.3170944,32086705.0686498,23990634.9663505,67945032.6822151,60773782.5988726,35819277.8663659,23938818.4844808,59727988.1891152,19959791.5279431,53269525.4623476,79352965.2590275,96314371.5332999,24041613.3371864,37392585.1617612,106032586.958613,95872737.6314413,21146334.1768357,23639269.3961717,44361267.6974529,6256495.48526792,13865708.1503927,21783398.1571614,37565792.9877614,30008483.6632024,55875663.035417,54397978.5989848,16454039.2507286,23193097.5727354,29997374.8837905,38304360.7668311,20576711.7412013,26640469.7604082,28012971.3931705,15323114.3038937,50130738.5743252,15057058.3882979,20601520.4747024,17302904.7306044,15622124.5188412,72784357.8754396,40608979.6744195,46322251.9673706,39296442.6245253,81236584.7549123,192398789.597345,29721913.4542012,48698581.7772354,21462113.4527133,17640884.6837533,94433602.8656888,48277367.7228452,21723250.2008774,50167357.0521743,20570254.9990081,28699127.4449136,107083733.295992,47955287.70842,63942891.7939315,106956133.353398,18808504.1852812,103278880.045192,77770268.4149334,39853224.3440629,23977133.3777474,49651344.2871545,34275854.3479048,17552135.4664088,46308854.5053739,168218405.244002,27283665.9014684,11148591.8144878,38033636.9224846,48378862.4848101,44664194.5010446,62323672.8816577,18144215.7644654,15895092.4274053,32648806.3683109,37096509.0382185,84635233.7428162,28165552.7989036,25350043.531852,34140796.9058659,52793227.3492753,32644711.4570388,64703651.8626704,30202361.8925276,32299249.0714928,40707822.6883202,23712947.207151,21198024.5184547,72081351.7017922,42720909.378311,57987883.5116025,64525691.3920173,37219865.0949631,49102082.0850825,19281646.5948816,95747213.6613937,24476178.5200009,25293040.6081089,57404320.20863,55687389.7864442,19249588.3437921,144246741.52252,41414387.4347451,67538095.356546,57517453.3624027,41588243.6540341,23568188.1471903,58841948.8605706,25438744.6971294,29011198.4787895,24150849.9159174,104756463.091727,42343772.6583963,11963095.0329074,155644995.84871,66809814.9886791,23907448.85246,30306130.917216,21503520.5682434,23346585.333991,35009033.9267412,14878632.1361993,44931548.5989756,46879667.337796,16086904.4509478,46715793.6564766,15536544.3647576,64728941.0096397,38644495.3346473,41081415.2687038,32377440.8937876,30730533.2111413,25695956.0097779,13136446.0114011,30127913.5496457,27017940.6754795,12180686.9852535,79861852.5625883,33566318.1321643,28006314.9201004,28711266.5664523,36361050.9167966,27069080.0126598,55078044.694123,24820147.7405202,36828920.1578566,64893061.4292353,33525147.1797842,18679194.6710972,22789527.9219928,58112862.6972101,66804286.7454962,27080606.1037584,53110452.3227881,39127442.1080556,78357327.5515318,70130193.4589266,28729225.5120469,26667853.3395191,40799480.0771425,13682145.0384049,52123014.3965044,54535958.0364046,14571379.2983742,18983311.740606,38602944.8714974,36931720.8097387,25631597.9588015,18415804.4242466,24854714.2843976,26354085.1113062,43365206.7395173,32740695.878103,140657136.401755,41973457.7660423,33352155.7900463,75785869.5974164,51833223.6007444,55866834.8033388,26615838.2033579,32373661.7799216,45400744.2570011,13485806.8293214,109290473.735233,43423703.349992,26272469.1869828,26898326.3425701,16232737.2936196,49101438.515408,21227809.6605413,212434365.311276,20582306.3915225,41655525.7468084,61742151.0555416,26208289.8520813,80634891.1186251,16059226.3759936,48637206.5545919,32229982.5378605,31893449.1437773,29774441.1671743,55634750.6418447,49846637.4563887,175605972.686482,41699703.3348052,26710534.3454496,19635232.3069554,21967276.262822,49968687.0972975,47469698.8771465,34242139.2968638,48942331.2547415,23972902.3953466,122635026.759485,54272645.5499665,19822383.2928618,49438412.3000845,49846091.1645834,102687987.048096,19359626.0319158,21550874.0767235,48067176.2550838,50334391.6359992,23761718.1851976,166307703.244531,66824886.5205439,47822173.2550722,23038019.3884318,27826855.6571182,15985490.583921,27894530.8618792,70177955.3555527,42999472.7084693,45848903.6371029,26806190.263741,29175554.8314773,38059057.4542291,57328326.3311381,167452637.936951,58084475.7077392,47462037.6055289,89949369.2970885,20615116.4815241,66612786.5393336,30349172.8906467,33052620.6318448,32676297.6972825,47417078.3823098,49240549.7710826,38063390.9507679,54976203.6634458,12051074.9908735,122190611.013829,55293026.2118731,33728707.7001024,26699613.1342247,37699907.2098347,142751294.963485,28003654.4571354,61738778.6709739,73205089.5419046,6570002.8877543,25636015.0609865,23826841.7019376,36919393.1620803,20471592.3162294,27964977.9070725,45587515.5250814,27936789.4990761,22817958.0685191,23917064.6755354,40577799.0632034,62730665.904446,50111155.4617501,68190669.2741463,33517609.0721861,27987233.3559836,44095296.8197547,20806742.1027956,42164621.4844503,169292004.279073],[4278.74877363247,663.64336722672,2623.77056203196,3982.72465148628,713.866767552672,8748.21094034804,3707.93778033865,968.475378916072,1725.75438539726,5587.51565546193,355.259672857124,5274.68902235749,3351.90464729442,3463.50679541321,550.222502106328,8372.31456548671,3694.92725806335,532.873191547191,1996.86384870394,4106.17015421173,641.105741954089,2439.91954069968,6339.22561472753,467.13941929494,4706.72734745081,5961.55225120209,429.560010650213,1114.88984945743,3654.54840024729,563.532645105723,5037.6127575705,3446.2435702726,4831.87547424371,3448.17775589085,12004.757797651,3880.78905912602,251.042235773552,4262.95724371678,3416.57374693296,3818.09535923224,1602.60458017111,2233.11948762298,3619.02519129896,3872.42384680475,5770.37703630344,4175.85146540909,953.604076357164,3069.33949568432,3603.99598797114,2852.33288621127,7646.08996273269,3215.16349006755,3455.77606813067,1270.72343308934,1440.46296819945,3654.70770316089,4472.37874456304,1048.13951655557,4756.70316766084,3806.02371961057,393.674654036849,6653.73330549672,4253.87451637298,227.685064675153,1589.57081672966,4550.47614976763,506.684441291323,4767.77908667815,6825.40304723946,4614.18861889467,1376.97510899698,1679.73932373808,9855.78703972309,7168.67327253904,275.682464129672,4112.33780689522,3629.37512316222,622.172525995856,2227.87550520691,3570.08022196236,813.466531087399,3609.41222274652,5153.60301956783,4735.91434543581,725.707234815978,2197.10829391897,3619.05695000883,3564.0260953913,1404.44885260921,1879.79803711359,3901.05048527283,508.018630565461,4199.38544105246,3580.52758262904,288.077373225139,1526.4541508054,1936.83124800029,4360.02082800718,431.881982745722,4980.83237540027,4335.64791002327,6450.95853788989,13325.349433455,5589.89873926938,5070.63378719184,514.306289145287,1767.95051294471,4251.40085256193,5374.04315382517,2269.42009800504,3765.60067933849,413.182449486093,2495.5289123666,6053.64225299553,428.205298886495,6168.79985252957,7364.27132618588,854.883334669061,9165.58937191078,7292.75609994096,3672.58906715164,2664.6669803069,4150.58879198469,3706.86534316565,1020.01324732118,5357.00890299752,13290.2358147352,4304.86187570427,688.649244811633,1700.65095831012,3746.00985963447,5130.66500943278,4844.24113164767,4090.16441081987,2320.53632420287,4023.76308970351,4287.62274163972,8923.98485929458,1444.57285273386,4364.7222204454,4216.73269789762,6443.87497229426,1262.35112843031,4064.64884071594,1770.44497174748,2201.14401846397,3536.39233250293,399.244793704826,1854.41481227798,6717.18375165158,4335.3098823932,5387.57881253818,5708.32739896352,5107.51611875403,5521.98515878009,439.277026102484,6715.42216211244,3784.7052259461,468.092978488793,5863.16360019885,6613.36333243999,3721.17269411538,8055.46957988602,5767.49284192543,5517.7725715106,3607.48718842107,3846.62285986563,4532.30848171322,6288.41495764834,4090.93690661191,86.172835539658,1517.98789667892,8402.08237593563,3921.88434040358,434.537526872211,9385.06803357246,4186.47699553247,2128.14322251248,4509.91503825855,2013.11592735258,4183.10645488317,1869.60359742086,2436.57018710972,4251.94466305673,4756.14359013615,2365.61730394294,3620.27398713232,509.270977304725,5340.57135777449,3066.42522720778,4347.35457525029,4903.17426566286,3232.26051162008,1671.98362575368,3636.15126415216,1373.29984409205,1661.5072728804,3698.00144435066,6708.33190173143,4971.72141359848,4182.6062606313,1366.61193841041,2351.86687361345,4285.4913937899,6016.63488569876,2484.75790174951,4169.15948146244,1469.01916517272,2289.17143365834,3661.33424391402,2473.23672855828,4789.13414019799,6535.1670428923,3615.08013246018,1186.0070701856,2752.15843267809,3752.0790717321,7507.11217931278,2699.28219010536,18.8140946041902,5883.9931831765,373.5910070814,5851.91971278221,5683.33134286697,3386.45958212809,997.666382518458,3542.83906241507,1670.98297743164,3746.97550844744,926.762986225297,1736.54021630902,3625.42643499809,1715.33703738543,3147.88197719868,10709.244821691,3609.92908094451,3338.96715421522,9543.72353448877,5247.2113946231,3547.61313878505,3700.15161448985,3562.86445598153,3508.10804508122,232.531721565182,8950.40896858798,4896.24303750297,571.871250582092,1555.62406606458,3702.52999556644,745.000117380921,2446.85229841718,12888.6045958516,3854.62416559171,3776.98618533027,5588.74265408155,3480.90319416337,3966.61270483254,422.619245087732,4200.23069413625,3773.83469668489,1975.25295720197,2605.18463926242,3824.19941725055,5406.72692788697,10316.4752736319,3131.97516991843,4352.33964265185,2510.42210795792,2177.13335904946,3627.73605603742,3705.00645275771,3300.38008402894,3563.67422281256,2661.20552918699,9375.41800436732,3729.00682437979,573.333875188037,4401.14337211316,4456.89723371039,8626.30150616277,260.249071740618,2494.29192110732,4321.37386571657,4889.11463061376,171.007593207555,11212.9146100063,3338.18074684523,4576.67207799174,284.533255833175,1880.12441382747,3456.32730746619,546.664281998043,7315.57879826303,2974.48012503665,3637.52589249008,2102.27471968897,4588.05716087931,3234.82943634726,4852.6018467794,9790.49092145291,3688.98794800541,2168.18954994511,6398.40258605888,1146.22946553946,3571.41801239213,3490.7265037644,3136.19861857914,3325.50140267138,3726.46336031521,579.653776715915,4099.47251787643,6054.52025816131,232.60775518106,10176.5597468001,3663.43036823594,2141.61766368567,3818.29383592447,2364.48583733167,10762.034302484,321.007384158129,6330.19098661141,7983.90264341185,3828.01953682352,425.41387460392,4098.65643783895,3638.09901605375,1056.43485722,1070.51443281651,3768.06763683658,547.292129296196,2813.63411495548,4183.73786286931,4809.31965800332,4407.54058280272,6536.2481530437,3547.10847368108,3155.26500540534,5270.35087882233,3720.59498268807,608.789161013864,2294.37283097765,11687.4219014211],[5014.62666795273,3418.55188503056,5716.49262815564,5955.05147343859,4163.27378936443,9496.30837740422,6387.43960935694,9196.53854501912,5416.38072653802,7018.25750424757,4814.61007274985,8993.9245804439,5937.55415346074,7134.88961099083,3459.20497590603,10783.9754340008,6016.22213229305,4586.23994181354,5792.28569182685,4909.11122323476,5444.31388134151,4618.15761818878,10028.803707639,3545.97910587999,6423.16212322584,10135.5100114979,4698.43469501659,5593.36420247218,5790.31864638283,3836.90906980475,6620.90888944912,5622.31459120561,6351.62177289725,5514.91027547728,13934.4767165396,7862.9930782296,3934.99561473154,6072.82203247034,6751.52393348195,5975.90366742416,3210.28517499315,5361.84514460506,5873.32802746609,7144.64017626897,7418.16474434537,6287.17766696362,6760.48566195959,7043.17880767573,10907.8214722494,5634.09688011896,7699.53567147205,6081.22802542949,3336.64205683122,9832.46776224901,3719.95003562227,8120.27178488427,6182.55998282619,4785.07164487242,7116.16478990576,5664.51278298935,4898.02357756172,8242.87769424096,7795.7541392012,5984.92087386007,4892.73118865944,7728.38846002937,4467.63824944938,7298.59749968086,8908.02813528491,9813.98856394789,4903.22478958353,6114.94768266755,10297.2125819861,9791.46248685258,4598.51434452864,4862.02317931247,6660.42548922011,2501.29875969823,3723.66864132574,4667.26881132439,6129.09397772308,5477.99996925907,7475.00254417462,7375.49853223393,4056.35788001116,4815.92125898414,5476.98593058175,6189.05168558408,4536.15605344452,5161.44066714015,5292.72816165449,3914.47497167803,7080.30638986232,3880.34256068944,4538.88978437485,4159.67603673705,3952.48333568166,8531.37491119922,6372.51753033442,6806.04525163994,6268.68747223255,9013.13401403265,13870.789076233,5451.780759917,6978.43691504304,4632.72203490704,4200.10531817397,9717.69534744164,6948.19168725541,4660.82076472346,7082.89185659179,4535.44430006676,5357.15665674559,10348.1270428997,6924.97564677451,7996.42994053793,10341.9598410262,4336.87723889912,10162.6217112117,8818.74528574975,6312.94102174754,4896.6451145399,7046.37100124273,5854.55842467259,4189.5268785877,6805.06094795439,12969.9038255495,5223.37686764687,3338.95070560914,6167.14171415613,6955.49153437844,6683.12759874032,7894.53436762788,4259.60277073642,3986.86498735602,5713.91340224113,6090.69035809723,9199.74096063667,5307.12283623656,5034.88267309696,5843.01265665802,7265.89480719858,5713.55506292175,8043.8580210413,5495.66755658743,5683.24283059354,6380.26823012326,4869.59415220108,4604.13124470346,8490.07371592215,6536.12342128811,7614.97757787917,8032.78851906468,6100.80856075349,7007.28778380641,4391.08717687108,9785.05051910279,4947.34055023514,5029.21868764015,7576.56387874015,7462.39839370991,4387.4352808665,12010.2764965058,6435.40110907976,8218.15644512478,7584.02619737054,6448.89476220803,4854.70783335005,7670.85059563609,5043.68364364076,5386.20445943054,4914.35142373004,10235.0604830517,6507.20928343297,3458.7707401485,12475.776362564,8173.72711733632,4889.5243994135,5505.10044569724,4637.1888648451,4831.83043307513,5916.84324000063,3857.28299923655,6703.09992458531,6846.87281448954,4010.84834554334,6834.89529228331,3941.64234358695,8045.42982131096,6216.4696842056,6409.47854889178,5690.1178277596,5543.51271407771,5069.11787294179,3624.42354194445,5488.89001070761,5197.87847832936,3490.08409429536,8936.54589663077,5793.64463288561,5292.09929235085,5358.28951872259,6030.01251381758,5202.79540369019,7421.45839401684,4981.98231033795,6068.68356053079,8055.62296965513,5790.090429327,4321.94339054749,4773.83786088225,7623.17930375576,8173.38893883658,5203.9029683266,7287.69183780352,6255.19321108913,8851.96743958832,8374.37719827132,5359.96506630845,5164.09269276987,6387.44707039851,3698.93836639716,7219.62702613538,7384.84651407222,3817.24760768465,4356.98424837708,6213.12681920283,6077.14742372922,5062.76584080298,4291.36393518968,4985.45025894328,5133.62300050425,6585.22640001976,5721.94860848146,11859.8961378992,6478.69259697065,5775.13253441393,8705.5080034089,7199.52940133898,7474.4120038528,5159.0540027565,5689.78574112607,6738.0074396665,3672.30266036467,10454.2084222208,6589.66640657871,5125.66768206668,5186.35964261736,4028.98712998932,7007.24186220285,4607.36471972225,14575.1283120004,4536.77268457684,6454.10921404406,7857.61739050341,5119.40327109335,8979.69326417251,4007.39645854932,6974.03803793698,5677.14563296209,5647.42854260037,5456.59611545278,7458.87060095861,7060.21511403078,13251.6403771942,6457.53074594347,5168.22351930038,4431.16602114561,4686.9260995691,7068.85330851458,6889.82575085513,5851.67833162963,6995.87959121235,4896.21306678402,11074.0700178157,7366.99705103555,4452.23351733282,7031.24543022675,7060.17642588225,10133.508131348,4399.95750342157,4642.29189912951,6933.04956387042,7094.6734693007,4874.5992845769,12896.0343999437,8174.64901512865,6915.35778214492,4799.7936818609,5275.11664867406,3998.18591162555,5281.52732283751,8377.22838148469,6557.39831857645,6771.18184936004,5177.46948457845,5401.44007015511,6169.20233532903,7571.54715570986,12940.349220054,7621.317189813,6889.26974399529,9484.16413275775,4540.38726118424,8161.66567186709,5509.00834004149,5749.14086032381,5716.31854407034,6886.00598186712,7017.1610905752,6169.55354549807,7414.59396484028,3471.46582740973,11053.9862047059,7435.92806661503,5807.64218079096,5167.1668382417,6140.02501703655,11947.8573377608,5291.84792460398,7857.40279424276,8555.99728505711,2563.20168690532,5063.20205610901,4881.27459808784,6076.13307639656,4524.55437764089,5288.1923099555,6751.85274758576,5285.52641645807,4776.81463619001,4890.50760918899,6370.07056971926,7920.26930757067,7078.92332644945,8257.7641813112,5789.43944369281,5290.29615012086,6640.42896353501,4561.44079242465,6493.42910059471,13011.2260866943],[0.0113936143146894,0.00177017356995446,0.00693697829471594,0.0111092601679114,0.00199241716423731,0.0231564724163638,0.00959636435068887,0.00256253215785759,0.00464638448984274,0.015128138297145,0.000977987555061526,0.015319394357148,0.00934334856168377,0.00997529187074107,0.00161668524161748,0.0216217090900302,0.0102575036190569,0.00148768847085056,0.00552806917900126,0.010927322518921,0.00174198595201008,0.00672113705126249,0.0163975044465102,0.00120980644029411,0.011608088781058,0.0165397926454224,0.00120593547941842,0.00303929039817707,0.0100265946273507,0.00155506530139944,0.0132055563061719,0.00993917750405753,0.014052550877505,0.00951667807896184,0.0326211363100845,0.00978922068489379,0.000636976535327367,0.0116652162691666,0.00893264939121348,0.0103669577162838,0.00434755026413317,0.00602112343690478,0.0100857319208694,0.0107770094098925,0.0151369892335201,0.0111877157345408,0.00255182574173136,0.00783040706706705,0.0101164958336587,0.00805393425752777,0.0221148476881672,0.00859636974941009,0.0087900957996441,0.00323709206480281,0.00362564678135957,0.00972986704557396,0.011610864783704,0.00286558589086148,0.0124433790426445,0.00985248364565387,0.00102499874383295,0.0176614798668705,0.011820692004172,0.000633644332640554,0.00446450411712924,0.012759914462735,0.00145408688470999,0.0138107591974792,0.0165527125996233,0.0126562319364946,0.00382261597467245,0.00480212490002474,0.0282526543382635,0.0202338055032725,0.000759315585081676,0.0109459058976062,0.0099332078093882,0.0017111985118241,0.00622436923589464,0.00995040925296683,0.00229539241197031,0.0102168675762062,0.0132487664848149,0.0130899032257705,0.00202629901000351,0.00635067925482606,0.00954780593569043,0.00921481036293348,0.00367861812165167,0.00457151721313498,0.0103481069748758,0.00137243133681821,0.0110314327126511,0.0102188594785409,0.000826598370637743,0.0044089548809092,0.00483635845672441,0.0111876160867211,0.00111818134837852,0.0124866527187589,0.0123894191740991,0.0181633738849935,0.0365206481981911,0.0139729426555442,0.0136440198493125,0.0014025485725701,0.00468974495509873,0.0110536900348253,0.0140476956143596,0.00599653593877717,0.0101095074097617,0.00111629190656492,0.00671930939935095,0.0160337499864671,0.00113117623862959,0.015445780943648,0.020490755663183,0.00241266209501105,0.0258739555389643,0.0196637650337092,0.00984162862747039,0.00697368595908482,0.0104257382534002,0.00973505442966228,0.00272185372880766,0.0153051323384567,0.038555125086344,0.0108790232021021,0.0017494396106098,0.00419983809483335,0.0100039512701986,0.0134820477708165,0.0121698116878747,0.0111648584132983,0.00652431847261229,0.0120805782566359,0.0123513273043312,0.0239962244209626,0.00394699892133994,0.01157825921793,0.0113631167749341,0.0171404667147441,0.00336312658715882,0.0111228373112949,0.00492649738162994,0.00612219764299236,0.00999968760135305,0.00116231109067442,0.00537642092273032,0.0173966010589135,0.0116851414515872,0.0147273729571919,0.0158526541744245,0.0130097928866348,0.0147807258674427,0.00117290283641027,0.0163685427089378,0.0102804342520099,0.00127291535881874,0.0163650340183393,0.0179522672398817,0.0101235226925625,0.0219995486343022,0.0163215774256524,0.0136744900611419,0.0102118989535987,0.0106246633277883,0.0129571322404207,0.0149253048176869,0.0111481449909557,0.000240015146892462,0.00419321505895792,0.0220270526002561,0.0105749672261408,0.00118295891342694,0.0232210068772351,0.0110214818532042,0.00566902373725819,0.0122216247129863,0.00521956943073835,0.0110778033450781,0.00500457253362291,0.00626131343484515,0.0112251298020833,0.0126409916928507,0.00645180320149577,0.0100028518632165,0.00141556156404694,0.0147802442676288,0.00804830730325018,0.0119215604592852,0.013466319945415,0.00889894927467991,0.00447956319110236,0.00962697611110068,0.00365035789105295,0.00440157927115239,0.00982665863915418,0.0177249231040274,0.0129724386641906,0.010893864977881,0.0036006664173498,0.00614093544529457,0.0111773466244493,0.0157440161348749,0.00649077881022803,0.0111623674676721,0.00395120052293268,0.00587583229206412,0.0096787061761919,0.00664438931827831,0.0132069298728681,0.0183102171971644,0.00971808937014165,0.00319743787133736,0.00717771823767881,0.0102993500612622,0.0203342295432646,0.00775586055735036,4.76768547855725e-05,0.0162226193300807,0.00101676219865963,0.0156901648807751,0.014726787744409,0.00975924517309623,0.00291102622181769,0.0105477807012806,0.00420082839855209,0.0101446680721762,0.00255092427386446,0.004755975542746,0.00963565929301408,0.00454233558910085,0.00824054947410391,0.0292373150725796,0.0094759922242598,0.00880202438890364,0.0252577380720397,0.01401691378471,0.00935550293155042,0.00970791356891191,0.00919477884949732,0.0097480992496365,0.00065736488757239,0.023946670743128,0.0136353012522479,0.00153327069962236,0.00416942842646285,0.0100746793525196,0.00205585866458053,0.00706774761983055,0.0371161158200192,0.010794881006972,0.0106897915997908,0.0164971080683987,0.00961486691712157,0.0106998448463553,0.00113181599941022,0.0112331223615271,0.009999188615274,0.0053104018839934,0.00708878411779162,0.00987195224234205,0.0136968159649813,0.0280233628043444,0.00835436265602975,0.0116546790084462,0.00682437332496927,0.00595196178273791,0.00993327148051452,0.0102710383023315,0.00879379625912533,0.00996463938438489,0.00742688247512336,0.0240203209639867,0.00970539115632282,0.00151157621182647,0.0123765085014832,0.0114005105197647,0.0245084604442536,0.000741777184641685,0.00711523574934151,0.0106776227604802,0.0141672301342198,0.000500410601221418,0.0305445712284141,0.0083754246796379,0.0127703650860684,0.000800337448572661,0.00516057497939518,0.0098174861074927,0.00154936821098022,0.0196252822283712,0.00782085156418913,0.0101049462283744,0.00584417997981846,0.0119806611289045,0.00905234163064411,0.0134088499628584,0.0251886671061301,0.0100834769891091,0.00586797350984007,0.0176556910182618,0.00293377189784919,0.00956508566676302,0.0094040797402198,0.00894639850097357,0.00874549028044943,0.00988920685893697,0.00154457183277113,0.0103517703881663,0.0168139164380973,0.000644794496689542,0.0262353637609723,0.00993443980469291,0.00581883361886571,0.0111453789067205,0.00603313462745807,0.0290309202325253,0.000857712042157565,0.0168440864441224,0.022758213090831,0.00989482213676872,0.00111815477810851,0.010429989267299,0.00993761759107704,0.00289144950913367,0.00293853548025973,0.0104722182416821,0.00151821226701268,0.00774642327854197,0.011166311137485,0.0125349203078406,0.01233781746644,0.0163579994242343,0.00981421525345945,0.00870845137726852,0.0132067110106516,0.00983516547016708,0.00161908411245093,0.00639738525583724,0.0311030201241279],[0.013382312952317,0.00913066688924266,0.0151272137189937,0.0166953696307437,0.0116012541481071,0.0249946184568366,0.0165046576077018,0.0242274611682321,0.0146099558623989,0.0189516027664262,0.0132415267725047,0.0261300169311608,0.0165810304300602,0.0204600530821261,0.0101668336866776,0.0278745493331823,0.0166047325803564,0.0127998513201286,0.0160261199047026,0.0130440232349191,0.0146345699553485,0.0126750456982266,0.0259156301186299,0.0091332791318685,0.0159256616530156,0.0282402218683471,0.0132169389212142,0.0152460263219376,0.0159002421393772,0.0104994440492049,0.0173484179666517,0.0161517871351934,0.018432819823598,0.0151819121637302,0.0378606286946939,0.0196333399431532,0.0100443387546417,0.0166307399133362,0.0176325652986633,0.0162322667334502,0.00879110048730453,0.0144468319643002,0.0164063827186961,0.0197956615536868,0.0195282684291965,0.0167620469739604,0.0181637895970013,0.017930047294684,0.0306479055403088,0.015858083269495,0.0223791370027704,0.016276496554615,0.00850121353289597,0.0250096658051986,0.00941580700093781,0.0216013381559536,0.015960505943169,0.0130766956923702,0.0186319865093511,0.014718200772234,0.0126990710823289,0.0218185086988853,0.0217583686901072,0.0166901363231899,0.0137151645422758,0.0218928356558202,0.0128779202624052,0.0212512516528664,0.0215761422836396,0.0269021412801617,0.0135799580424775,0.0174037614822028,0.029479776063622,0.027624535235941,0.0126686051588733,0.0129469668047036,0.0183348051423386,0.00689353197407018,0.010427292754891,0.0129902180113996,0.0174232165686522,0.0155351509078234,0.0192015658409971,0.0203236533367025,0.0113279109048273,0.0138673233052078,0.0144640282961211,0.016039794580571,0.0119297268135693,0.0124207389345658,0.0140660691995874,0.010534780962553,0.0186143164384255,0.0110907645898097,0.0129774236417709,0.0120155078592686,0.00988480930146626,0.0217803006419889,0.0166088730207663,0.0170546208458816,0.0179631877442222,0.0254878781486936,0.0379581597907944,0.0136020756193483,0.0187626152661294,0.0126189769939694,0.0111179664778825,0.0252465585597138,0.0180694866492468,0.0123352248366798,0.0188307946231943,0.0122686557844847,0.0143898669302563,0.0272317775442366,0.0183357921419559,0.0199449047300977,0.028484408088395,0.0121513522669086,0.0285452266740101,0.023739627821657,0.0169797895499815,0.0128430231008355,0.0176903889323062,0.0154050541326664,0.0110932468987701,0.0193581234261736,0.0376236729387858,0.0131888889390942,0.00852801532732227,0.0152663544851236,0.0184119593518586,0.0175146364046952,0.019851401206648,0.0116933933813119,0.0111536158315497,0.0171394187196626,0.0175336235142491,0.0246062505989454,0.0145503698193707,0.0133912357186542,0.0157588207202225,0.0194442352379844,0.015236661167904,0.0220294627439459,0.0153145295070017,0.0157922765320543,0.0180997335609486,0.0140674397683915,0.0132701828588634,0.0219850180522649,0.0176704082454816,0.0207710913296751,0.0221905814784505,0.0155585868368828,0.018801858172988,0.0116946236519695,0.0239258741598562,0.0135145290583231,0.0136577806300709,0.0210410361301429,0.0202672925428168,0.0119508982591485,0.0327627105929177,0.0181967700122477,0.0204425017848537,0.0215346717124422,0.0178222347766949,0.0138890139248559,0.0183450295535027,0.0137005749389905,0.0150627658254693,0.0135207110482403,0.0268438004783649,0.017433838783539,0.00940520576363081,0.0307482546132466,0.0214204905210596,0.0130044287984491,0.0149485088638651,0.0119531609575587,0.0128360858203568,0.0157752589980577,0.00991580214710208,0.0174600240721651,0.0182215823442312,0.0109687560519357,0.0189947389606911,0.0109334568810139,0.0223481193419018,0.0163374780021001,0.0174599505775286,0.0155970493741611,0.01521955608358,0.0135946711052822,0.00956402737622004,0.0145179556073879,0.0137062822944012,0.00919285785761057,0.0236602792814641,0.0150510952639455,0.0136910614187053,0.0140548973075039,0.015719904884342,0.013629674712852,0.0194154984217322,0.0129704175607397,0.0161767432155814,0.0217890467930257,0.0148842499308786,0.0114961132954089,0.0127768832522033,0.0209821180252189,0.0229105342394794,0.0139805446513099,0.0198364602467795,0.0162617523141876,0.0244361968625315,0.0227119474926975,0.0154521681952666,0.0130611857893036,0.0176843694252908,0.0100920992651847,0.019332333408897,0.0191696722396407,0.0109984952922963,0.0126041252338783,0.0185574024209691,0.01523884161374,0.0136517665719776,0.0118563449076024,0.0136528177413176,0.0136924679722062,0.0174857466592819,0.0148796745068834,0.0324263887507486,0.017046614262478,0.0151933027985454,0.0231107033830332,0.0191956378237292,0.0196998461154071,0.0134326615885119,0.0146706864544192,0.0187538193748256,0.0104212860365273,0.028081998757331,0.0183013741699469,0.0138027263790824,0.0138994097743085,0.0109511857608616,0.0191661157442766,0.0133163441970476,0.0418814644759225,0.012730771198617,0.0182849155851683,0.023134954968548,0.0141644573902914,0.0243897235647135,0.010712460756401,0.0186725083973176,0.0150939407215588,0.0151180352506887,0.0149299868259507,0.0193325760709065,0.0179610672123451,0.0359489714150981,0.017228594639484,0.0137670489828632,0.0120252747529171,0.0127612922434177,0.0192794537901107,0.0191772883042298,0.0155857536608358,0.0194375898189517,0.0136719337558065,0.0283473110660006,0.0191035558861629,0.0117461711673542,0.0197554775039244,0.018026733606382,0.0288083194778088,0.012549136678742,0.0132652846413753,0.0171084821807403,0.0204670295578272,0.0142353225084208,0.035291040742004,0.0205101307966412,0.0193037054147967,0.0135100790824932,0.0143847564888056,0.0112863346670559,0.014910519627969,0.0225745869779233,0.0172255924813764,0.0187530245535559,0.0144646070155811,0.014089401337414,0.0171269196815963,0.0209943460569342,0.0332929874689199,0.0208039429180124,0.0187896388429885,0.0263451973834425,0.0116384466086109,0.0216479358513679,0.0148260052705602,0.0164969942340162,0.0150111481089485,0.0182321546885548,0.0185471056194769,0.0155391096052733,0.020499454446232,0.00964817150503686,0.0284698708709028,0.0201617140615272,0.0157635266161244,0.0151139094494947,0.0157251180579469,0.0324017840851399,0.0140933188712578,0.0209924842042926,0.024370366789935,0.00665459953688048,0.0132928630970466,0.0124474209170651,0.0165986980158865,0.0124035444163112,0.0145073807918465,0.0189251043473486,0.0146447832101652,0.0131275671267838,0.013050441922339,0.0166597128982703,0.0221160439062702,0.0177240231135725,0.0228899109531674,0.0159401156180467,0.0132832329252434,0.0174744959346982,0.0121176010944596,0.0181149015723861,0.0345349501060143]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>boot<\\/th>\\n      <th>prior_name<\\/th>\\n      <th>bs_post_mean<\\/th>\\n      <th>bs_post_mean_pe<\\/th>\\n      <th>bs_post_var<\\/th>\\n      <th>bs_post_var_pe<\\/th>\\n      <th>bs_post_sd<\\/th>\\n      <th>bs_post_sd_pe<\\/th>\\n      <th>bs_post_cov<\\/th>\\n      <th>bs_post_cov_pe<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":12,\"lengthMenu\":[12,20,40,100],\"columnDefs\":[{\"targets\":9,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":10,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":8,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,3,4,5,6,7,8,9,10]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\",\"options.columnDefs.5.render\",\"options.columnDefs.6.render\",\"options.columnDefs.7.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n### CDFs of scaled bootstraps - no process error  {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# probs_retained_bs calculated above\n\n# combine the original and bootstrapped priors now\ncdfs <- rbind( list_primary$dt_probs[, .(model_num, prior_name, posterior, reserve)][, boot := 0],\n               list_bs$dt_probs[, .(boot, model_num, prior_name, posterior, reserve)]  )\n\nsetorder(cdfs, boot, prior_name, reserve)\ncdfs[, cdf := cumsum(posterior), keyby=.(boot, prior_name)]\n\n# plot\nggplot(data=cdfs, aes(x=reserve, y=cdf, colour = factor(boot), alpha = factor(boot), linewidth = factor(boot)))+\n  geom_line()+\n  facet_wrap(~prior_name)+\n  scale_colour_manual(values=c(me_colours$red, rep(me_colours$grey, max(cdfs$boot))))+\n  scale_alpha_manual(values=c(1, rep(0.25, max(cdfs$boot))))+\n  scale_linewidth_manual(values=c(2, rep(0.5, max(cdfs$boot))))+\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale()))+\n  theme(legend.position=\"none\")+\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-31-1.png){width=960}\n:::\n:::\n\n\n\n### CDFs of scaled bootstraps - with process error  {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# probs_retained_bs calculated above\n\n# combine the original and bootstrapped priors now\ncdfs <- rbind( list_primary$dt_probs[, .(model_num, prior_name, posterior, reserve)][, boot := 0],\n               list_bs$dt_probs[, .(boot, model_num, prior_name, posterior, reserve_pe)][, reserve := reserve_pe][, reserve_pe := NULL]  )\n\nsetorder(cdfs, boot, prior_name, reserve)\ncdfs[, cdf := cumsum(posterior), keyby=.(boot, prior_name)]\n\n# plot\nggplot(data=cdfs, aes(x=reserve, y=cdf, colour = factor(boot), alpha = factor(boot), linewidth = factor(boot)))+\n  geom_line()+\n  facet_wrap(~prior_name)+\n  scale_colour_manual(values=c(me_colours$red, rep(me_colours$grey, max(cdfs$boot))))+\n  scale_alpha_manual(values=c(1, rep(0.25, max(cdfs$boot))))+\n  scale_linewidth_manual(values=c(2, rep(0.5, max(cdfs$boot))))+\n  scale_x_continuous(labels = label_number(scale_cut = cut_short_scale()))+\n  theme(legend.position=\"none\")+\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-32-1.png){width=960}\n:::\n:::\n\n\n\n\n:::\n\n\n\n### Comparison with previous results\n\nIn Section 5.4.2 of the [CAS monograph](https://www.casact.org/monograph/cas-monograph-no-3), we used the bootstrap to estimate parameter and process error and found a coefficient of variation of prediction of 3.8%. \n\nOur results for the two main priors are 3.5% and 5.1% so in a similar ball-park. *A priori* we'd expect low internal model structural error for this data set since we know that it is well represented by a chain ladder model, while a small number of interactions improve it further. It's also quite small and simple so we can be confidence that we're not missing model structure.\n\nThe GLM results in the monograph were not subject to any filtering of results for inappropriate extrapolation so may have slightly overstated parameter and process error. As noted in our paper (Section 7.4), results can be quite sensitive to inclusion gates.\n\n\n## Conclusion\n\nIn this tutorial we've worked through the our forecast error estimation process. The same code can be used for larger data sets, such as the synthetic data sets from the paper, with the relevant adjustments (mainly high-level stuff, e.g. appropriate parameters for creating the basis functions).\n\nWhile some of this functionality is specific to models fitted with a Lasso (e.g. prior specification and selection), other parts (e.g. the filtering) are of relevance to any bootstrapping exercise, whether underpinned by a machine learning algorithm, a GLM or even a chain ladder.\n\nFinally, don't forget about the other components of forecast error, specifically external model error, which may require other, more qualitative methods to assess.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/datatables-binding-0.27/datatables.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}